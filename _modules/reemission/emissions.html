<!DOCTYPE html>
<html lang="en"
      data-content_root="../../"
      x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }"
      x-init="$watch('darkMode', val => localStorage.setItem('darkMode', val))"
      class="scroll-smooth"
      :class="{'dark': darkMode === 'dark' || (darkMode === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)}"
>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="utf-8" />
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="white" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="black" />
  
    <title>reemission.emissions | ReEmission 1.0.0 documentation</title>
    <meta property="og:title" content="reemission.emissions | ReEmission 1.0.0 documentation" />
    <meta name="twitter:title" content="reemission.emissions | ReEmission 1.0.0 documentation" />
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=c842c44c" />
      <link rel="stylesheet" type="text/css" href="../../_static/theme.css?v=ecdfb4fc" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
        <link rel="search" title="Search" href="../../search.html" />
        <link rel="index" title="Index" href="../../genindex.html" />

    <script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
<body x-data="{ showSidebar: false }" class="min-h-screen font-sans antialiased bg-background text-foreground" :class="{ 'overflow-hidden': showSidebar }">
    <div x-cloak x-show="showSidebar" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" @click.self="showSidebar = false"></div><div id="page" class="relative flex flex-col min-h-screen"><a href="#content" class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100">
      Skip to content
    </a><header
  class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
    <div class="hidden mr-4 md:flex">
      <a href="../../index.html" class="flex items-center mr-6"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">ReEmission 1.0.0 documentation</span>
      </a></div><button
      class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden"
      type="button" @click="showSidebar = true">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" aria-hidden="true"
        fill="currentColor">
        <path
          d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z" />
      </svg>
      <span class="sr-only">Toggle navigation menu</span>
    </button>
    <div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
      <div class="flex-1 w-full md:w-auto md:flex-none"><form id="searchbox"
      action="../../search.html"
      method="get"
      class="relative flex items-center group"
      @keydown.k.window.meta="$refs.search.focus()">
  <input x-ref="search"
          name="q"
          id="search-input"
          type="search"
          aria-label="Search the docs"
          placeholder="Search ..."
          class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" />
  <kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
    <span class="text-xs">âŒ˜</span>
    K
  </kbd>
</form>
      </div>
      <nav class="flex items-center space-x-1">
        <button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'"
          class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9"
          type="button"
          aria-label="Color theme switcher">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
            class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0">
            <path
              d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z" />
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
            class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100">
            <path
              d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z" />
          </svg>
        </button>
      </nav>
    </div>
  </div>
</header>

    <div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside id="left-sidebar"
  class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky"
  :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }">

    <a href="../../index.html" class="!justify-start text-sm md:!hidden bg-background"><span class="font-bold text-clip whitespace-nowrap">ReEmission 1.0.0 documentation</span>
    </a>

    <div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
      <div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">About the Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">Theoretical Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation/install_package.html">Installing RE-Emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/using_docker.html">About Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/building_image.html">Building the ReEmission Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/using_image.html">Using the ReEmission Docker Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../running_docker.html">Running the ReEmission Docker Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demo.html">Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../json.html">JSON file format description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reporting.html">Reporting Calculation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualisation.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geocaret_integration.html">Integration with GeoCARET</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/reemission.html">Python API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.model.html">Model (Main)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.input.html">Input Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.reservoir.html">Reservoir Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.catchment.html">Catchment Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.ns_catchment.html">Post-impoundment catchment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.emissions.html">Emissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.temperature.html">MonthlyTemperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.biogenic.html">Biogenic Factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.profile.html">Emission Profile Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.presenter.html">Presenter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.utils.html">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.auxiliary.html">Auxiliary functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.constants.html">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.mixins.html">Mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.document_compiler.html">Document <span class="math notranslate nohighlight">\(\LaTeX\)</span> Compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.exceptions.html">Custom Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.app_logger.html">App Logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.download.html">External Data Downloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.globals.html">Global variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/reemission.main.html">Main</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

</nav>
      </div>
    </div>
    <button type="button" @click="showSidebar = false"
      class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
        stroke="none" class="h-4 w-4">
        <path
          d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z" />
      </svg>
    </button>
  </aside>
        <main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs"
     class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
  <a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground"
     href="../../index.html">
    <span class="hidden md:inline">ReEmission 1.0.0 documentation</span>
    <svg xmlns="http://www.w3.org/2000/svg"
         height="18"
         width="18"
         viewBox="0 96 960 960"
         aria-label="Home"
         fill="currentColor"
         stroke="none"
         class="md:hidden">
      <path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z" />
    </svg>
  </a>
  
<div class="mr-1">/</div><a class="hover:text-foreground overflow-hidden text-ellipsis whitespace-nowrap"
       href="../index.html">Module code</a>
    
<div class="mr-1">/</div><span aria-current="page"
        class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">reemission.emissions</span>
</nav>

    <div id="content" role="main">
      <h1>Source code for reemission.emissions</h1><div class="highlight"><pre>
<span></span><code><span id="line-1"><span class="sd">&quot;&quot;&quot;Classes for calculating GHG emissions from reservoirs.</span>
</span><span id="line-2">
</span><span id="line-3"><span class="sd">.. _Praire2021: https://www.sciencedirect.com/science/article/pii/S1364815221001602</span>
</span><span id="line-4">
</span><span id="line-5"><span class="sd">The net GHG emission is meant to represent the actual emission exclusively</span>
</span><span id="line-6"><span class="sd">attributable to the reservoir impoundment and are calculated as follows:</span>
</span><span id="line-7">
</span><span id="line-8"><span class="sd">Net GHG emission = (</span>
</span><span id="line-9"><span class="sd">    Post-ipmoundment balance from the catchment -</span>
</span><span id="line-10"><span class="sd">    Pre-impoundment balance from the catchment -</span>
</span><span id="line-11"><span class="sd">    Emissions from the reservoir due to unrelated anthropogenic sources)</span>
</span><span id="line-12">
</span><span id="line-13"><span class="sd">The emissions are calculated for the complete life time of reservoirs that is</span>
</span><span id="line-14"><span class="sd">assumed = 100 years.</span>
</span><span id="line-15">
</span><span id="line-16"><span class="sd">**Contains:**</span>
</span><span id="line-17">
</span><span id="line-18"><span class="sd">    * **Emission** base class from which all other emission classes are derived.</span>
</span><span id="line-19"><span class="sd">    * **CarbonDioxideEmission** for calculating CO$_2$ emissions.</span>
</span><span id="line-20"><span class="sd">    * **MethaneEmission** for calculating CH$_4$ emissions.</span>
</span><span id="line-21"><span class="sd">    * **NitrousOxideEmission** for calculating N$_2$O emissions.</span>
</span><span id="line-22">
</span><span id="line-23"><span class="sd">Note:</span>
</span><span id="line-24">
</span><span id="line-25"><span class="sd">    Equations implemented in the methods in the below classes are the same</span>
</span><span id="line-26"><span class="sd">    equations introduded by Praire et al. 2021 (Praire2021_) and share the same equation</span>
</span><span id="line-27"><span class="sd">    references.</span>
</span><span id="line-28"><span class="sd">    </span>
</span><span id="line-29"><span class="sd">The paper of Praire et al. Praire2021_ is given below:</span>
</span><span id="line-30">
</span><span id="line-31"><span class="sd">.. code-block:: bibtex</span>
</span><span id="line-32">
</span><span id="line-33"><span class="sd">    @article{Praire2021,</span>
</span><span id="line-34"><span class="sd">    title = {A new modelling framework to assess biogenic GHG emissions from reservoirs: The G-res tool},</span>
</span><span id="line-35"><span class="sd">    journal = {Environmental Modelling &amp; Software},</span>
</span><span id="line-36"><span class="sd">    volume = {143},</span>
</span><span id="line-37"><span class="sd">    pages = {105117},</span>
</span><span id="line-38"><span class="sd">    year = {2021},</span>
</span><span id="line-39"><span class="sd">    issn = {1364-8152},</span>
</span><span id="line-40"><span class="sd">    doi = {https://doi.org/10.1016/j.envsoft.2021.105117},</span>
</span><span id="line-41"><span class="sd">    url = {https://www.sciencedirect.com/science/article/pii/S1364815221001602},</span>
</span><span id="line-42"><span class="sd">    author = {Yves T. Prairie and Sara Mercier-Blais and John A. Harrison and Cynthia Soued and Paul del Giorgio and Atle Harby and Jukka Alm and Vincent Chanudet and Roy Nahas}}</span>
</span><span id="line-43"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-44"><span class="kn">import</span> <span class="nn">os</span>
</span><span id="line-45"><span class="kn">import</span> <span class="nn">math</span>
</span><span id="line-46"><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="line-47"><span class="kn">import</span> <span class="nn">configparser</span>
</span><span id="line-48"><span class="kn">import</span> <span class="nn">pathlib</span>
</span><span id="line-49"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
</span><span id="line-50"><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="line-51"><span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">SimpleNamespace</span>
</span><span id="line-52"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">ClassVar</span>
</span><span id="line-53"><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="line-54"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="line-55"><span class="kn">from</span> <span class="nn">reemission.utils</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="line-56">    <span class="n">read_config</span><span class="p">,</span> <span class="n">read_table</span><span class="p">,</span> <span class="n">save_return</span><span class="p">,</span> <span class="n">get_package_file</span><span class="p">,</span> <span class="n">load_yaml</span><span class="p">)</span>
</span><span id="line-57"><span class="kn">from</span> <span class="nn">reemission.constants</span> <span class="kn">import</span> <span class="n">Landuse</span>
</span><span id="line-58"><span class="kn">from</span> <span class="nn">reemission.catchment</span> <span class="kn">import</span> <span class="n">Catchment</span>
</span><span id="line-59"><span class="kn">from</span> <span class="nn">reemission.reservoir</span> <span class="kn">import</span> <span class="n">Reservoir</span>
</span><span id="line-60"><span class="kn">from</span> <span class="nn">reemission.ns_catchment</span> <span class="kn">import</span> <span class="n">NSCatchmentCreator</span>
</span><span id="line-61"><span class="kn">from</span> <span class="nn">reemission.temperature</span> <span class="kn">import</span> <span class="n">MonthlyTemperature</span>
</span><span id="line-62"><span class="kn">from</span> <span class="nn">reemission.exceptions</span> <span class="kn">import</span> <span class="n">WrongN2OModelError</span>
</span><span id="line-63"><span class="kn">from</span> <span class="nn">reemission.globals</span> <span class="kn">import</span> <span class="n">internal</span>
</span><span id="line-64">
</span><span id="line-65">
</span><span id="line-66"><span class="n">INI_FILE</span> <span class="o">=</span> <span class="n">get_package_file</span><span class="p">(</span><span class="s2">&quot;config/config.ini&quot;</span><span class="p">)</span>
</span><span id="line-67"><span class="n">TABLES</span> <span class="o">=</span> <span class="n">get_package_file</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">)</span>
</span><span id="line-68">
</span><span id="line-69"><span class="c1"># Set up module logger</span>
</span><span id="line-70"><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span><span id="line-71"><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="line-72">
</span><span id="line-73">
</span><span id="line-74"><span class="n">internals_config</span> <span class="o">=</span> <span class="n">load_yaml</span><span class="p">(</span><span class="n">get_package_file</span><span class="p">(</span><span class="s2">&quot;config/internal_vars.yaml&quot;</span><span class="p">))</span>
</span><span id="line-75">
</span><span id="line-76">
<div class="viewcode-block" id="check_preimpoundment_area">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.check_preimpoundment_area">[docs]</a>
</span><span id="line-77"><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="line-78"><span class="k">def</span> <span class="nf">check_preimpoundment_area</span><span class="p">(</span><span class="n">preimp_area</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">reservoir_area</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">reservoir_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-79"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-80"><span class="sd">    Checks if the pre-impoundment area is larger than the reservoir area and logs a warning if it is.</span>
</span><span id="line-81">
</span><span id="line-82"><span class="sd">    Args:</span>
</span><span id="line-83"><span class="sd">        preimp_area (float): The pre-impoundment area of the reservoir in square units.</span>
</span><span id="line-84"><span class="sd">        reservoir_area (float): The current area of the reservoir in square units.</span>
</span><span id="line-85"><span class="sd">        reservoir_name (str): The name of the reservoir.</span>
</span><span id="line-86">
</span><span id="line-87"><span class="sd">    Returns:</span>
</span><span id="line-88"><span class="sd">        None</span>
</span><span id="line-89">
</span><span id="line-90"><span class="sd">    Logs:</span>
</span><span id="line-91"><span class="sd">        Warning message if the pre-impoundment area is larger than the reservoir area.</span>
</span><span id="line-92"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-93">    <span class="k">if</span> <span class="n">preimp_area</span> <span class="o">&gt;</span> <span class="n">reservoir_area</span><span class="p">:</span>
</span><span id="line-94">        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pre impoundment area for reservoir &#39;</span><span class="si">{</span><span class="n">reservoir_name</span><span class="si">}</span><span class="s2">&#39; larger than the reservoir area.&quot;</span><span class="p">)</span></div>

</span><span id="line-95">
</span><span id="line-96">
<div class="viewcode-block" id="Emission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission">[docs]</a>
</span><span id="line-97"><span class="nd">@dataclass</span>  <span class="c1"># type: ignore</span>
</span><span id="line-98"><span class="k">class</span> <span class="nc">Emission</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="line-99"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for all emissions.</span>
</span><span id="line-100">
</span><span id="line-101"><span class="sd">    Attributes:</span>
</span><span id="line-102"><span class="sd">        catchment (Catchment): Catchment object with catchment data and methods.</span>
</span><span id="line-103"><span class="sd">        reservoir (Reservoir): Reservoir object with reservoir data and methods.</span>
</span><span id="line-104"><span class="sd">        preinund_area (float): Pre-inundation area of a reservoir, in hectares.</span>
</span><span id="line-105"><span class="sd">        config (configparser.ConfigParser): ConfigParser object containing configuration from an .ini file with equation constants.</span>
</span><span id="line-106">
</span><span id="line-107"><span class="sd">    Note:</span>
</span><span id="line-108"><span class="sd">        This class defines two generic methods that must be implemented in all emission subclasses:</span>
</span><span id="line-109"><span class="sd">        - ``profile``: Calculates emission decay over a set of years.</span>
</span><span id="line-110"><span class="sd">        - ``factor``: Calculates total emission over the lifespan of the reservoir.</span>
</span><span id="line-111"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-112">    <span class="n">catchment</span><span class="p">:</span> <span class="n">Catchment</span>
</span><span id="line-113">    <span class="n">reservoir</span><span class="p">:</span> <span class="n">Reservoir</span>
</span><span id="line-114">    <span class="n">preinund_area</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="line-115">    <span class="n">config</span><span class="p">:</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span>
</span><span id="line-116">
<div class="viewcode-block" id="Emission.__init__">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission.__init__">[docs]</a>
</span><span id="line-117">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catchment</span><span class="p">,</span> <span class="n">reservoir</span><span class="p">,</span> <span class="n">preinund_area</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="line-118">                 <span class="n">config_file</span><span class="o">=</span><span class="n">INI_FILE</span><span class="p">):</span>
</span><span id="line-119"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-120"><span class="sd">        Initializes the Emission object.</span>
</span><span id="line-121">
</span><span id="line-122"><span class="sd">        Args:</span>
</span><span id="line-123"><span class="sd">            catchment (Catchment): Catchment object containing catchment data and methods.</span>
</span><span id="line-124"><span class="sd">            reservoir (Reservoir): Reservoir object containing reservoir data and methods.</span>
</span><span id="line-125"><span class="sd">            preinund_area (float, optional): Pre-inundation area of the reservoir in hectares. Defaults to None.</span>
</span><span id="line-126"><span class="sd">            config_file (str): Path to the configuration file. Defaults to ``INI_FILE``.</span>
</span><span id="line-127"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-128">        <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span> <span class="o">=</span> <span class="n">catchment</span>
</span><span id="line-129">        <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span> <span class="o">=</span> <span class="n">reservoir</span>
</span><span id="line-130">        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">read_config</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
</span><span id="line-131">        <span class="k">if</span> <span class="n">preinund_area</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-132">            <span class="bp">self</span><span class="o">.</span><span class="n">preinund_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">river_area_before_impoundment</span><span class="p">()</span>
</span><span id="line-133">        <span class="c1"># Check if preinindation area is not larger than reservoir area</span>
</span><span id="line-134">        <span class="n">check_preimpoundment_area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preinund_area</span><span class="p">,</span> <span class="n">reservoir</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">reservoir</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

</span><span id="line-135">
<div class="viewcode-block" id="Emission._par_from_config">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission._par_from_config">[docs]</a>
</span><span id="line-136">    <span class="k">def</span> <span class="nf">_par_from_config</span><span class="p">(</span>
</span><span id="line-137">            <span class="bp">self</span><span class="p">,</span> <span class="n">list_of_constants</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="line-138">            <span class="n">section_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleNamespace</span><span class="p">:</span>
</span><span id="line-139"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-140"><span class="sd">        Reads constants (parameters) from the configuration file.</span>
</span><span id="line-141">
</span><span id="line-142"><span class="sd">        Args:</span>
</span><span id="line-143"><span class="sd">            list_of_constants (list): List of parameter names to read from the config file.</span>
</span><span id="line-144"><span class="sd">            section_name (str): The section in the config file to read the parameters from.</span>
</span><span id="line-145">
</span><span id="line-146"><span class="sd">        Returns:</span>
</span><span id="line-147"><span class="sd">            SimpleNamespace: A namespace containing the parameters read from the config file.</span>
</span><span id="line-148"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-149">        <span class="n">const_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">par_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="n">par_name</span><span class="p">)</span>
</span><span id="line-150">                      <span class="k">for</span> <span class="n">par_name</span> <span class="ow">in</span> <span class="n">list_of_constants</span><span class="p">}</span>
</span><span id="line-151">        <span class="k">return</span> <span class="n">SimpleNamespace</span><span class="p">(</span><span class="o">**</span><span class="n">const_dict</span><span class="p">)</span></div>

</span><span id="line-152">
<div class="viewcode-block" id="Emission.profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission.profile">[docs]</a>
</span><span id="line-153">    <span class="nd">@abstractmethod</span>
</span><span id="line-154">    <span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-155"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-156"><span class="sd">        Calculates emission profile in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$ over a number of years years.</span>
</span><span id="line-157">
</span><span id="line-158"><span class="sd">        Args:</span>
</span><span id="line-159"><span class="sd">            years (Tuple[int, ...]): A tuple containing the years over which to calculate the emission profile.</span>
</span><span id="line-160">
</span><span id="line-161"><span class="sd">        Returns:</span>
</span><span id="line-162"><span class="sd">            List[float]: A list of emission values for each year.</span>
</span><span id="line-163"><span class="sd">        &quot;&quot;&quot;</span></div>

</span><span id="line-164">
<div class="viewcode-block" id="Emission.factor">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission.factor">[docs]</a>
</span><span id="line-165">    <span class="nd">@abstractmethod</span>
</span><span id="line-166">    <span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-167"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-168"><span class="sd">        Calculates total emission (factor).</span>
</span><span id="line-169">
</span><span id="line-170"><span class="sd">        Args:</span>
</span><span id="line-171"><span class="sd">            number_of_years (int): The number of years over which to calculate the total emission.</span>
</span><span id="line-172">
</span><span id="line-173"><span class="sd">        Returns:</span>
</span><span id="line-174"><span class="sd">            float: Total emission per m$^2$ of the reservoir per year over the lifespan of the reservoir, in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-175"><span class="sd">        &quot;&quot;&quot;</span></div>

</span><span id="line-176">
<div class="viewcode-block" id="Emission.total_emission_per_year">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission.total_emission_per_year">[docs]</a>
</span><span id="line-177">    <span class="nd">@abstractmethod</span>
</span><span id="line-178">    <span class="k">def</span> <span class="nf">total_emission_per_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-179"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-180"><span class="sd">        Calculates total reservoir emission per year over the lifespan of the reservoir.</span>
</span><span id="line-181">
</span><span id="line-182"><span class="sd">        Args:</span>
</span><span id="line-183"><span class="sd">            number_of_years (int): The number of years over which to calculate the total emission per year.</span>
</span><span id="line-184">
</span><span id="line-185"><span class="sd">        Returns:</span>
</span><span id="line-186"><span class="sd">            float: Total reservoir emission per year, in tCO$_{2e}$/year.</span>
</span><span id="line-187"><span class="sd">        &quot;&quot;&quot;</span></div>

</span><span id="line-188">
<div class="viewcode-block" id="Emission.total_lifetime_emission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.Emission.total_lifetime_emission">[docs]</a>
</span><span id="line-189">    <span class="nd">@abstractmethod</span>
</span><span id="line-190">    <span class="k">def</span> <span class="nf">total_lifetime_emission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-191"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-192"><span class="sd">        Calculates total reservoir emission over its lifetime.</span>
</span><span id="line-193">
</span><span id="line-194"><span class="sd">        Args:</span>
</span><span id="line-195"><span class="sd">            number_of_years (int): The number of years over which to calculate the total lifetime emission.</span>
</span><span id="line-196">
</span><span id="line-197"><span class="sd">        Returns:</span>
</span><span id="line-198"><span class="sd">            float: Total reservoir emission over its lifetime, in tCO$_{2e}$.</span>
</span><span id="line-199"><span class="sd">        &quot;&quot;&quot;</span></div>
</div>

</span><span id="line-200">
<div class="viewcode-block" id="CarbonDioxideEmission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission">[docs]</a>
</span><span id="line-201"><span class="nd">@dataclass</span>
</span><span id="line-202"><span class="k">class</span> <span class="nc">CarbonDioxideEmission</span><span class="p">(</span><span class="n">Emission</span><span class="p">):</span>
</span><span id="line-203"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for calculating CO$_2$ emissions.</span>
</span><span id="line-204">
</span><span id="line-205"><span class="sd">    Attributes:</span>
</span><span id="line-206"><span class="sd">        eff_temp (float): Effective temperature for CO$_2$.</span>
</span><span id="line-207"><span class="sd">        p_calc_method (str): Method used for calculating annual discharge of P from</span>
</span><span id="line-208"><span class="sd">            catchment to the reservoir.</span>
</span><span id="line-209"><span class="sd">        par (SimpleNamespace): Indexable structure of equation parameters for emission</span>
</span><span id="line-210"><span class="sd">            calculations.</span>
</span><span id="line-211"><span class="sd">        pre_impoundment_table (Dict): Dictionary of pre-impoundment emission factors.</span>
</span><span id="line-212"><span class="sd">        use_red_area (bool): If True, P exports are calculated using the area</span>
</span><span id="line-213"><span class="sd">            surface and composition calculated as a difference between the</span>
</span><span id="line-214"><span class="sd">            catchment area and the reservoir area.</span>
</span><span id="line-215">
</span><span id="line-216"><span class="sd">    Note:</span>
</span><span id="line-217"><span class="sd">        Total CO$_2$ emission =</span>
</span><span id="line-218"><span class="sd">            Diffusive CO$_2$ emission (gross total post-impoundment) +</span>
</span><span id="line-219"><span class="sd">            - Pre-impoundment emission +</span>
</span><span id="line-220"><span class="sd">            - Unrelated non-anthropogenic emission</span>
</span><span id="line-221"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-222">
</span><span id="line-223">    <span class="n">eff_temp</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="line-224">    <span class="n">p_calc_method</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="line-225">    <span class="n">par</span><span class="p">:</span> <span class="n">SimpleNamespace</span>
</span><span id="line-226">    <span class="n">pre_impoundment_table</span><span class="p">:</span> <span class="n">Dict</span>
</span><span id="line-227">    <span class="n">use_red_area</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="line-228">
<div class="viewcode-block" id="CarbonDioxideEmission.__init__">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.__init__">[docs]</a>
</span><span id="line-229">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catchment</span><span class="p">:</span> <span class="n">Catchment</span><span class="p">,</span> <span class="n">reservoir</span><span class="p">:</span> <span class="n">Reservoir</span><span class="p">,</span> <span class="n">eff_temp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="line-230">                 <span class="n">p_calc_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">preinund_area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="line-231">                 <span class="n">config_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">INI_FILE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-232"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-233"><span class="sd">        Initializes the CarbonDioxideEmission object.</span>
</span><span id="line-234">
</span><span id="line-235"><span class="sd">        Args:</span>
</span><span id="line-236"><span class="sd">            catchment (Catchment): Catchment object containing catchment data and methods.</span>
</span><span id="line-237"><span class="sd">            reservoir (Reservoir): Reservoir object containing reservoir data and methods.</span>
</span><span id="line-238"><span class="sd">            eff_temp (float): Effective temperature for CO$_2$.</span>
</span><span id="line-239"><span class="sd">            p_calc_method (str): Method used for calculating annual discharge of P from the catchment to the reservoir.</span>
</span><span id="line-240"><span class="sd">            preinund_area (Optional[float]): Pre-inundation area of the reservoir in hectares. Defaults to None.</span>
</span><span id="line-241"><span class="sd">            config_file (pathlib.Path): Path to the configuration file. Defaults to INI_FILE.</span>
</span><span id="line-242"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-243">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="line-244">            <span class="n">catchment</span><span class="o">=</span><span class="n">catchment</span><span class="p">,</span> <span class="n">reservoir</span><span class="o">=</span><span class="n">reservoir</span><span class="p">,</span>
</span><span id="line-245">            <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span> <span class="n">preinund_area</span><span class="o">=</span><span class="n">preinund_area</span><span class="p">)</span>
</span><span id="line-246">        <span class="c1"># Initialise input data specific to carbon dioxide emissions</span>
</span><span id="line-247">        <span class="bp">self</span><span class="o">.</span><span class="n">eff_temp</span> <span class="o">=</span> <span class="n">eff_temp</span>  <span class="c1"># EFF temp CO2</span>
</span><span id="line-248">        <span class="n">avail_p_calc_methods</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;g-res&#39;</span><span class="p">,</span> <span class="s1">&#39;mcdowell&#39;</span><span class="p">)</span>
</span><span id="line-249">        <span class="k">if</span> <span class="n">p_calc_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">avail_p_calc_methods</span><span class="p">:</span>
</span><span id="line-250">            <span class="n">p_calc_method</span> <span class="o">=</span> <span class="s1">&#39;g-res&#39;</span>
</span><span id="line-251">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="line-252">                <span class="s2">&quot;Invalid P calculation method. Expected: </span><span class="si">%s</span><span class="s2">. &quot;</span> <span class="o">+</span>
</span><span id="line-253">                <span class="s2">&quot;Using default g-res method.&quot;</span><span class="p">,</span>
</span><span id="line-254">                <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">avail_p_calc_methods</span><span class="p">))</span>
</span><span id="line-255">        <span class="bp">self</span><span class="o">.</span><span class="n">p_calc_method</span> <span class="o">=</span> <span class="n">p_calc_method</span>
</span><span id="line-256">        <span class="c1"># Read equation parameters an the pre-impoundment table</span>
</span><span id="line-257">        <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_par_from_config</span><span class="p">(</span>
</span><span id="line-258">            <span class="n">list_of_constants</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k1_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k2_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k3_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k4_diff&#39;</span><span class="p">,</span>
</span><span id="line-259">                               <span class="s1">&#39;k5_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k6_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k7_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;conv_coeff&#39;</span><span class="p">,</span>
</span><span id="line-260">                               <span class="s1">&#39;co2_gwp100&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_C&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_CO2&#39;</span><span class="p">],</span>
</span><span id="line-261">            <span class="n">section_name</span><span class="o">=</span><span class="s1">&#39;CARBON_DIOXIDE&#39;</span><span class="p">)</span>
</span><span id="line-262">        <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment_table</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span>
</span><span id="line-263">            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TABLES</span><span class="p">,</span> <span class="s1">&#39;Carbon_Dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;pre-impoundment.yaml&#39;</span><span class="p">),</span>
</span><span id="line-264">            <span class="n">schema_file</span> <span class="o">=</span> <span class="n">get_package_file</span><span class="p">(</span><span class="s2">&quot;schemas/pre_impoundment_schema.json&quot;</span><span class="p">))</span>
</span><span id="line-265">        <span class="c1"># Read from config</span>
</span><span id="line-266">        <span class="bp">self</span><span class="o">.</span><span class="n">use_red_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="s1">&#39;CALCULATIONS&#39;</span><span class="p">,</span><span class="s1">&#39;use_ns_catchment&#39;</span><span class="p">)</span></div>

</span><span id="line-267">
</span><span id="line-268">    <span class="nd">@property</span>
</span><span id="line-269">    <span class="nd">@save_return</span><span class="p">(</span><span class="n">internal</span><span class="p">,</span> <span class="n">internals_config</span><span class="p">[</span><span class="s1">&#39;reservoir_tp&#39;</span><span class="p">][</span><span class="s1">&#39;include&#39;</span><span class="p">])</span>
</span><span id="line-270">    <span class="k">def</span> <span class="nf">reservoir_tp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-271"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-272"><span class="sd">        Returns the reservoir total phosphorus concentration in $\mu$g/L.</span>
</span><span id="line-273"><span class="sd">        </span>
</span><span id="line-274"><span class="sd">        Returns:</span>
</span><span id="line-275"><span class="sd">            float: Reservoir total phosphorus concentration in $\mu$g/L.</span>
</span><span id="line-276"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-277">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_red_area</span><span class="p">:</span>
</span><span id="line-278">            <span class="n">catchment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span>
</span><span id="line-279">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-280">            <span class="c1"># Calculate reduced catchment area as a difference between the</span>
</span><span id="line-281">            <span class="c1"># original catchment and the reservoir.</span>
</span><span id="line-282">            <span class="n">catchment</span> <span class="o">=</span> <span class="n">NSCatchmentCreator</span><span class="p">(</span>
</span><span id="line-283">                <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="p">)</span><span class="o">.</span><span class="n">get_catchment</span><span class="p">()</span>
</span><span id="line-284">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">reservoir_conc</span><span class="p">(</span>
</span><span id="line-285">            <span class="n">inflow_conc</span><span class="o">=</span><span class="n">catchment</span><span class="o">.</span><span class="n">inflow_p_conc</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_calc_method</span><span class="p">),</span>
</span><span id="line-286">            <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;CALCULATIONS&#39;</span><span class="p">][</span><span class="s1">&#39;ret_coeff_method&#39;</span><span class="p">])</span>
</span><span id="line-287">
</span><span id="line-288">    <span class="nd">@property</span>
</span><span id="line-289">    <span class="nd">@save_return</span><span class="p">(</span><span class="n">internal</span><span class="p">,</span> <span class="n">internals_config</span><span class="p">[</span><span class="s1">&#39;reservoir_tn&#39;</span><span class="p">][</span><span class="s1">&#39;include&#39;</span><span class="p">])</span>
</span><span id="line-290">    <span class="k">def</span> <span class="nf">reservoir_tn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-291"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-292"><span class="sd">        Returns the reservoir total nitrogen concentration in $\mu$g/L.</span>
</span><span id="line-293"><span class="sd">        </span>
</span><span id="line-294"><span class="sd">        Returns:</span>
</span><span id="line-295"><span class="sd">            float: Reservoir total nitrogen concentration in $\mu$g/L.</span>
</span><span id="line-296"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-297">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_red_area</span><span class="p">:</span>
</span><span id="line-298">            <span class="n">catchment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span>
</span><span id="line-299">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-300">            <span class="c1"># Calculate reduced catchment area as a difference between the</span>
</span><span id="line-301">            <span class="c1"># original catchment and the reservoir.</span>
</span><span id="line-302">            <span class="n">catchment</span> <span class="o">=</span> <span class="n">NSCatchmentCreator</span><span class="p">(</span>
</span><span id="line-303">                <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="p">)</span><span class="o">.</span><span class="n">get_catchment</span><span class="p">()</span>
</span><span id="line-304">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">reservoir_conc</span><span class="p">(</span>
</span><span id="line-305">            <span class="n">inflow_conc</span><span class="o">=</span><span class="n">catchment</span><span class="o">.</span><span class="n">inflow_n_conc</span><span class="p">(),</span>
</span><span id="line-306">            <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;CALCULATIONS&#39;</span><span class="p">][</span><span class="s1">&#39;ret_coeff_method&#39;</span><span class="p">])</span>
</span><span id="line-307">        
</span><span id="line-308">
<div class="viewcode-block" id="CarbonDioxideEmission.pre_impoundment">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.pre_impoundment">[docs]</a>
</span><span id="line-309">    <span class="k">def</span> <span class="nf">pre_impoundment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-310"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-311"><span class="sd">        Calculates CO$_2$ emissions from the inundated area prior to impoundment.</span>
</span><span id="line-312">
</span><span id="line-313"><span class="sd">        Uses a table of pre-impoundment emissions per land cover category</span>
</span><span id="line-314"><span class="sd">        and soil type, in tCO$_2$-C/ha/yr.</span>
</span><span id="line-315">
</span><span id="line-316"><span class="sd">        Returns:</span>
</span><span id="line-317"><span class="sd">            float: Unit pre-impoundment emission in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-318"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-319">        <span class="n">_list_of_landuses</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">list</span><span class="p">(</span><span class="n">Landuse</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_member_map_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="line-320">        <span class="n">climate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">biogenic_factors</span><span class="o">.</span><span class="n">climate</span>
</span><span id="line-321">        <span class="n">soil_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">biogenic_factors</span><span class="o">.</span><span class="n">soil_type</span>
</span><span id="line-322">        <span class="c1"># Find which landuses are supported from the first entry of pre-impoundment table</span>
</span><span id="line-323">        <span class="n">supported_landuses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment_table</span><span class="p">[</span><span class="s1">&#39;boreal&#39;</span><span class="p">][</span><span class="s1">&#39;mineral&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="line-324">        <span class="n">emissions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-325">        <span class="k">for</span> <span class="n">landuse</span><span class="p">,</span> <span class="n">fraction</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">_list_of_landuses</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area_fractions</span><span class="p">):</span>
</span><span id="line-326">            <span class="k">if</span> <span class="n">landuse</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_landuses</span><span class="p">:</span>
</span><span id="line-327">                <span class="k">continue</span>
</span><span id="line-328">            <span class="c1"># Area in ha allocated to each landuse (reservoir.area in km2)</span>
</span><span id="line-329">            <span class="n">area_landuse</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="n">fraction</span>
</span><span id="line-330">            <span class="n">coeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment_table</span><span class="p">[</span><span class="n">climate</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="n">soil_type</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="n">landuse</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
</span><span id="line-331">            <span class="n">emissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">area_landuse</span> <span class="o">*</span> <span class="n">coeff</span><span class="p">)</span>
</span><span id="line-332">        <span class="c1"># Total emission in t CO2-C /yr</span>
</span><span id="line-333">        <span class="n">tot_emission</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">emissions</span><span class="p">)</span>
</span><span id="line-334">        <span class="c1"># Total emission in g CO2e m-2 yr-1. To convert from gCO2-C to gCO2</span>
</span><span id="line-335">        <span class="c1"># The unit emission is divided by C to CO2 molecular weight ratio, i.e.</span>
</span><span id="line-336">        <span class="c1"># 44/12</span>
</span><span id="line-337">        <span class="n">c_co2_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_C</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CO2</span>
</span><span id="line-338">        <span class="k">return</span> <span class="n">tot_emission</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">c_co2_ratio</span> <span class="o">*</span> \
</span><span id="line-339">            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">co2_gwp100</span></div>

</span><span id="line-340">
<div class="viewcode-block" id="CarbonDioxideEmission.diffusion_flux">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.diffusion_flux">[docs]</a>
</span><span id="line-341">    <span class="k">def</span> <span class="nf">diffusion_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-342"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-343"><span class="sd">        Calculates CO$_2$ diffusive flux for a given year/age in years.</span>
</span><span id="line-344">
</span><span id="line-345"><span class="sd">        Args:</span>
</span><span id="line-346"><span class="sd">            year (int): The year for which to calculate the diffusive flux.</span>
</span><span id="line-347"><span class="sd">            time_horizon (int): The time horizon for calculating GWP value. Defaults to 100.</span>
</span><span id="line-348">
</span><span id="line-349"><span class="sd">        Returns:</span>
</span><span id="line-350"><span class="sd">            float: The diffusive flux value in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-351"><span class="sd">        </span>
</span><span id="line-352"><span class="sd">        **CO$_2$ diffusion flux equation:**</span>
</span><span id="line-353"><span class="sd">        </span>
</span><span id="line-354"><span class="sd">        .. math::</span>
</span><span id="line-355">
</span><span id="line-356"><span class="sd">            \begin{eqnarray}</span>
</span><span id="line-357"><span class="sd">            q_{CO_2, diffusion} (t, n) &amp; = &amp; 10^\left( k_1^{diff} + k_2^{diff} \, \log_{10} (t) + k_3^{diff} \, T_{eff,CO_2} + k_4^{diff} \, \log_{10} (A_{res}) +  k_5^{diff} \, m_{sc} + k_6^{diff} \, \log_{10} (C_{TP}) \right) \\</span>
</span><span id="line-358"><span class="sd">            &amp; &amp; \times \left(1 - \frac{A_{pre}}{A_{res}}\right) \times \frac{44}{12} \times \frac{1}{1000} \times 365 \times \textrm{gwp}_{CO_2}^{n}</span>
</span><span id="line-359"><span class="sd">            \end{eqnarray}</span>
</span><span id="line-360"><span class="sd">            </span>
</span><span id="line-361"><span class="sd">        where:</span>
</span><span id="line-362"><span class="sd">        * $t$ is the reservoir age, years</span>
</span><span id="line-363"><span class="sd">        * $n$ is the time horizon for calculating GWP value, years</span>
</span><span id="line-364"><span class="sd">        * $T_{eff,CO_2}$ is the effective temperature for CO$_2$, degC</span>
</span><span id="line-365"><span class="sd">        * $A_{res}$ is the reservoir area, km$^2$</span>
</span><span id="line-366"><span class="sd">        * $m_{sc}$ is the mass of C in inundated area, kg/m$^2$</span>
</span><span id="line-367"><span class="sd">        * $C_{TP}$ is the reservoir Total P conc., $\mu$g/L</span>
</span><span id="line-368"><span class="sd">        * $A_{pre}$ is the preinundation (river) area, km$^2$</span>
</span><span id="line-369"><span class="sd">        * 44/12 is a molecular weight ratio between CO$_2$ and C</span>
</span><span id="line-370"><span class="sd">        * 365 is used to convert emissions from d$^{-1}$ to yr$^{-1}$</span>
</span><span id="line-371"><span class="sd">        * 1/1000 is used to convert the unit from mg to g</span>
</span><span id="line-372"><span class="sd">        * $\textrm{gwp}_{CO_2}^{n}$ is the global warming potential for CO$_2$ over n years (deafault n = 100)</span>
</span><span id="line-373"><span class="sd">            </span>
</span><span id="line-374"><span class="sd">        Note:</span>
</span><span id="line-375"><span class="sd">            Eq. 7 in Praire2021_</span>
</span><span id="line-376"><span class="sd">            n=169, R2=0.36, RMSE=0.39, Outliers=3</span>
</span><span id="line-377"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-378">
</span><span id="line-379">        <span class="c1"># Time horizon is required to quantify GWP value, which differs</span>
</span><span id="line-380">        <span class="c1"># depending on the number of years for which global warming potential</span>
</span><span id="line-381">        <span class="c1"># is quantified.</span>
</span><span id="line-382">        <span class="k">if</span> <span class="n">time_horizon</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="line-383">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="line-384">                <span class="s2">&quot;Currently, the tool supports time horizon of 100 years only.&quot;</span><span class="p">)</span>
</span><span id="line-385">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">co2_gwp100</span>
</span><span id="line-386">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-387">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">co2_gwp100</span>
</span><span id="line-388">
</span><span id="line-389">        <span class="n">flux</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="line-390">            <span class="n">gwp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CO2</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_C</span><span class="o">/</span><span class="mi">1000</span><span class="o">*</span><span class="mf">365.25</span>
</span><span id="line-391">            <span class="o">*</span> <span class="mf">10.0</span>
</span><span id="line-392">            <span class="o">**</span> <span class="p">(</span>
</span><span id="line-393">                <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k1_diff</span>
</span><span id="line-394">                <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k2_diff</span>
</span><span id="line-395">                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eff_temp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k3_diff</span>
</span><span id="line-396">                <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k4_diff</span>
</span><span id="line-397">                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">soil_carbon</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k5_diff</span>
</span><span id="line-398">                <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_tp</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k6_diff</span>
</span><span id="line-399">            <span class="p">)</span>
</span><span id="line-400">            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preinund_area</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span><span class="p">)))</span>
</span><span id="line-401">        <span class="k">return</span> <span class="n">flux</span></div>

</span><span id="line-402">
<div class="viewcode-block" id="CarbonDioxideEmission.diffusion_flux_int">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.diffusion_flux_int">[docs]</a>
</span><span id="line-403">    <span class="k">def</span> <span class="nf">diffusion_flux_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-404"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-405"><span class="sd">        Calculate gross total CO$_2$ emissions in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$ from a reservoir integrated over a number of years (n = 100 years by default).</span>
</span><span id="line-406">
</span><span id="line-407"><span class="sd">        Args:</span>
</span><span id="line-408"><span class="sd">            number_of_years (int): The number of years over which to integrate the emissions. Defaults to 100.</span>
</span><span id="line-409">
</span><span id="line-410"><span class="sd">        Returns:</span>
</span><span id="line-411"><span class="sd">            float: Gross total CO$_2$ emissions in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-412">
</span><span id="line-413"><span class="sd">        **Gross total (integrated) CO$_2$ emission (via diffusion):**</span>
</span><span id="line-414"><span class="sd">        </span>
</span><span id="line-415"><span class="sd">        .. math::</span>
</span><span id="line-416">
</span><span id="line-417"><span class="sd">            \begin{eqnarray}</span>
</span><span id="line-418"><span class="sd">            q_{CO_2, gross} (n) &amp; = &amp; q_{CO_2, diffusion} (t=1, n) \times \textrm{gwp}_{CO_2}^{n} \times \\</span>
</span><span id="line-419"><span class="sd">            &amp; &amp; \frac{n^{k_2^{diff}+1} - 0.5^{k_2^{diff}+1}}{(k_2^{diff}+1)*(n-0.5)}</span>
</span><span id="line-420"><span class="sd">            \end{eqnarray}</span>
</span><span id="line-421"><span class="sd">            </span>
</span><span id="line-422"><span class="sd">        where:</span>
</span><span id="line-423"><span class="sd">        </span>
</span><span id="line-424"><span class="sd">        * $n$ is the number of years the emission is sumed up for</span>
</span><span id="line-425"><span class="sd">        * $\textrm{gwp}_{CO_2}^{n}$ is the global warming potential of CO$_2$ over n years</span>
</span><span id="line-426"><span class="sd">        </span>
</span><span id="line-427"><span class="sd">        Note:</span>
</span><span id="line-428"><span class="sd">        </span>
</span><span id="line-429"><span class="sd">            Eq. 8 in Praire2021_</span>
</span><span id="line-430"><span class="sd">            Currently, integration over 100 years is supported by the tool and n=100 years is the default value.</span>
</span><span id="line-431"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-432">        <span class="n">flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> \
</span><span id="line-433">            <span class="p">(</span><span class="n">number_of_years</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k7_diff</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="line-434">             <span class="mf">0.5</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k7_diff</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> \
</span><span id="line-435">            <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k7_diff</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">number_of_years</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
</span><span id="line-436">        <span class="k">return</span> <span class="n">flux</span></div>

</span><span id="line-437">
<div class="viewcode-block" id="CarbonDioxideEmission.diffusion_flux_nonanthro">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.diffusion_flux_nonanthro">[docs]</a>
</span><span id="line-438">    <span class="k">def</span> <span class="nf">diffusion_flux_nonanthro</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-439"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-440"><span class="sd">        Calculate nonanthropogenic CO$_2$ flux as CO$_2$ (diffusive) flux after 100 years.</span>
</span><span id="line-441"><span class="sd">        </span>
</span><span id="line-442"><span class="sd">        Note:</span>
</span><span id="line-443"><span class="sd">        </span>
</span><span id="line-444"><span class="sd">            It is assumed that all anthropogenic effects become null after 100 years and the flux that remains after 100 years is due to non-anthropogenic sources.</span>
</span><span id="line-445">
</span><span id="line-446"><span class="sd">        Returns:</span>
</span><span id="line-447"><span class="sd">            float: Nonanthropogenic CO$_2$ flux in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-448"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-449">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></div>

</span><span id="line-450">
<div class="viewcode-block" id="CarbonDioxideEmission._diffusion_flux_profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission._diffusion_flux_profile">[docs]</a>
</span><span id="line-451">    <span class="k">def</span> <span class="nf">_diffusion_flux_profile</span><span class="p">(</span>
</span><span id="line-452">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-453">            <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> \
</span><span id="line-454">            <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="line-455"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-456"><span class="sd">        Calculate CO$_2$ fluxes for a given tuple of years.</span>
</span><span id="line-457">
</span><span id="line-458"><span class="sd">        Args:</span>
</span><span id="line-459"><span class="sd">            years (Tuple[int, ...]): A tuple of years for which to calculate the CO$_2$ fluxes.</span>
</span><span id="line-460">
</span><span id="line-461"><span class="sd">        Returns:</span>
</span><span id="line-462"><span class="sd">            List[float]: List of CO$_2$ fluxes for each year in the tuple.</span>
</span><span id="line-463"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-464">        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span></div>

</span><span id="line-465">
<div class="viewcode-block" id="CarbonDioxideEmission.net_total">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.net_total">[docs]</a>
</span><span id="line-466">    <span class="k">def</span> <span class="nf">net_total</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-467"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-468"><span class="sd">        Calculates net total CO$_2$ emissions, i.e. gross - non anthropogenic</span>
</span><span id="line-469"><span class="sd">        (in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$) from a reservoir over a number of years.</span>
</span><span id="line-470">
</span><span id="line-471"><span class="sd">        Args:</span>
</span><span id="line-472"><span class="sd">            number_of_years (int, optional): Number of years to calculate net emissions for. Defaults to 100.</span>
</span><span id="line-473">
</span><span id="line-474"><span class="sd">        Returns:</span>
</span><span id="line-475"><span class="sd">            float: Net total CO$_2$ emissions in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-476"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-477">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux_int</span><span class="p">(</span><span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">-</span> \
</span><span id="line-478">            <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux_nonanthro</span><span class="p">()</span></div>

</span><span id="line-479">
<div class="viewcode-block" id="CarbonDioxideEmission.profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.profile">[docs]</a>
</span><span id="line-480">    <span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="line-481">                <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> \
</span><span id="line-482">            <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-483"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-484"><span class="sd">        Calculates CO$_2$ emissions for a number of years.</span>
</span><span id="line-485"><span class="sd">        </span>
</span><span id="line-486"><span class="sd">        Note:</span>
</span><span id="line-487"><span class="sd">            Flux at year x age - pre-impoundment emissions - non-anthropogenic</span>
</span><span id="line-488"><span class="sd">        emissions, unit: gCO$_{2e}$ m$^{-2}$ yr$^{-1}$</span>
</span><span id="line-489">
</span><span id="line-490"><span class="sd">        Args:</span>
</span><span id="line-491"><span class="sd">            years (Tuple[int, ...], optional): Tuple of years to calculate CO$_2$ emissions for. Defaults to (1, 5, 10, 20, 30, 40, 50, 100).</span>
</span><span id="line-492">
</span><span id="line-493"><span class="sd">        Returns:</span>
</span><span id="line-494"><span class="sd">            List[float]: List of CO$_2$ emission values in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-495"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-496">        <span class="n">pre_impoundment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment</span><span class="p">()</span>
</span><span id="line-497">        <span class="n">non_anthro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux_nonanthro</span><span class="p">()</span>
</span><span id="line-498">        <span class="n">diffusion_flux_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_flux_profile</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
</span><span id="line-499">        <span class="n">out_profile</span> <span class="o">=</span> <span class="p">[</span><span class="n">flux</span> <span class="o">-</span> <span class="n">non_anthro</span> <span class="o">-</span> <span class="n">pre_impoundment</span> <span class="k">for</span>
</span><span id="line-500">                       <span class="n">flux</span> <span class="ow">in</span> <span class="n">diffusion_flux_profile</span><span class="p">]</span>
</span><span id="line-501">        <span class="k">return</span> <span class="n">out_profile</span></div>

</span><span id="line-502">
<div class="viewcode-block" id="CarbonDioxideEmission.factor">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.factor">[docs]</a>
</span><span id="line-503">    <span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-504"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-505"><span class="sd">        Calculates overall integrated emissions for lifetime.</span>
</span><span id="line-506">
</span><span id="line-507"><span class="sd">        Args:</span>
</span><span id="line-508"><span class="sd">            number_of_years (int, optional): Number of years to integrate emissions over. Defaults to 100.</span>
</span><span id="line-509">
</span><span id="line-510"><span class="sd">        Returns:</span>
</span><span id="line-511"><span class="sd">            float: Overall integrated emissions in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$</span>
</span><span id="line-512"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-513">        <span class="n">net_total_emission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net_total</span><span class="p">(</span><span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span>
</span><span id="line-514">        <span class="n">pre_impoundment_emission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment</span><span class="p">()</span>
</span><span id="line-515">        <span class="k">return</span> <span class="n">net_total_emission</span> <span class="o">-</span> <span class="n">pre_impoundment_emission</span></div>

</span><span id="line-516">
<div class="viewcode-block" id="CarbonDioxideEmission.total_emission_per_year">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.total_emission_per_year">[docs]</a>
</span><span id="line-517">    <span class="k">def</span> <span class="nf">total_emission_per_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-518"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-519"><span class="sd">        Calculates total reservoir emission per year in tCO$_{2e}$ / year.</span>
</span><span id="line-520">
</span><span id="line-521"><span class="sd">        Args:</span>
</span><span id="line-522"><span class="sd">            number_of_years (int, optional): Number of years to calculate emissions for. Defaults to 100.</span>
</span><span id="line-523">
</span><span id="line-524"><span class="sd">        Returns:</span>
</span><span id="line-525"><span class="sd">            float: Total reservoir emission per year in tCO$_{2e}$ / year.</span>
</span><span id="line-526"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-527">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> \
</span><span id="line-528">            <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span></div>

</span><span id="line-529">
<div class="viewcode-block" id="CarbonDioxideEmission.total_lifetime_emission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.CarbonDioxideEmission.total_lifetime_emission">[docs]</a>
</span><span id="line-530">    <span class="k">def</span> <span class="nf">total_lifetime_emission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-531"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-532"><span class="sd">        Calculates total reservoir emission per lifetime in ktCO$_{2e}$.</span>
</span><span id="line-533">
</span><span id="line-534"><span class="sd">        Args:</span>
</span><span id="line-535"><span class="sd">            number_of_years (int, optional): Number of years to calculate emissions for. Defaults to 100.</span>
</span><span id="line-536">
</span><span id="line-537"><span class="sd">        Returns:</span>
</span><span id="line-538"><span class="sd">            float: Total reservoir emission per lifetime in ktCO$_{2e}$.</span>
</span><span id="line-539"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-540">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_emission_per_year</span><span class="p">(</span>
</span><span id="line-541">            <span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> <span class="n">number_of_years</span> <span class="o">/</span> <span class="mi">1_000</span></div>
</div>

</span><span id="line-542">
</span><span id="line-543">
<div class="viewcode-block" id="MethaneEmission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission">[docs]</a>
</span><span id="line-544"><span class="nd">@dataclass</span>
</span><span id="line-545"><span class="k">class</span> <span class="nc">MethaneEmission</span><span class="p">(</span><span class="n">Emission</span><span class="p">):</span>
</span><span id="line-546"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for calculating methane emissions from reservoirs.</span>
</span><span id="line-547">
</span><span id="line-548"><span class="sd">    Attributes:</span>
</span><span id="line-549"><span class="sd">        monthly_temp  (MonthlyTemperature): A vector of averaged monthly temperatures.</span>
</span><span id="line-550"><span class="sd">        mean_ir (float): mean infrared radiation in kWh/m$^2$/d.</span>
</span><span id="line-551"><span class="sd">        pre_impoundment_table (dict): Parameters for calculating pre-impoundment CH$_4$ emissions. None, if table could not be loaded.</span>
</span><span id="line-552"><span class="sd">        par: subset of parameters relate to CH$_4$ emissions found in ``config.ini``</span>
</span><span id="line-553">
</span><span id="line-554"><span class="sd">    Note:</span>
</span><span id="line-555"><span class="sd">        Gross total CH$_4$ emission (in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$ is calculated as a sum of the</span>
</span><span id="line-556"><span class="sd">            following pathways/processes:</span>
</span><span id="line-557"><span class="sd">            * CH$_4$ diffusive emissions.</span>
</span><span id="line-558"><span class="sd">            * CH$_4$ bubbling emission (ebullition).</span>
</span><span id="line-559"><span class="sd">            * CH$_4$ degassing emissions.</span>
</span><span id="line-560">
</span><span id="line-561"><span class="sd">        All of the three above processes are integrated over 100 years.</span>
</span><span id="line-562">
</span><span id="line-563"><span class="sd">        Total CH$_4$ emission = Gross total CH$_4$ emission (post-impoundment)+</span>
</span><span id="line-564"><span class="sd">                             - Pre-impoundment emission +</span>
</span><span id="line-565"><span class="sd">                             - Unrelated non-anthropogenic emission</span>
</span><span id="line-566"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-567">
</span><span id="line-568">    <span class="n">monthly_temp</span><span class="p">:</span> <span class="n">MonthlyTemperature</span>
</span><span id="line-569">
<div class="viewcode-block" id="MethaneEmission.__init__">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.__init__">[docs]</a>
</span><span id="line-570">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catchment</span><span class="p">:</span> <span class="n">Catchment</span><span class="p">,</span> <span class="n">reservoir</span><span class="p">:</span> <span class="n">Reservoir</span><span class="p">,</span> 
</span><span id="line-571">                 <span class="n">monthly_temp</span><span class="p">:</span> <span class="n">MonthlyTemperature</span><span class="p">,</span>
</span><span id="line-572">                 <span class="n">preinund_area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="line-573">                 <span class="n">config_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">INI_FILE</span><span class="p">):</span>
</span><span id="line-574"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize `MethaneEmission` instance.</span>
</span><span id="line-575">
</span><span id="line-576"><span class="sd">        Args:</span>
</span><span id="line-577"><span class="sd">            catchment (Catchment): Catchment object representing the catchment area.</span>
</span><span id="line-578"><span class="sd">            reservoir (Reservoir): Reservoir object representing the reservoir.</span>
</span><span id="line-579"><span class="sd">            monthly_temp (MonthlyTemperature): MonthlyTemperature object for monthly temperature data.</span>
</span><span id="line-580"><span class="sd">            preinund_area (float, optional): Pre-inundation area in hectares.</span>
</span><span id="line-581"><span class="sd">            config_file (pathlib.Path, optional): Path to the configuration file (default: INI_FILE).</span>
</span><span id="line-582"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-583">        <span class="bp">self</span><span class="o">.</span><span class="n">monthly_temp</span> <span class="o">=</span> <span class="n">monthly_temp</span>
</span><span id="line-584">        <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment_table</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span>
</span><span id="line-585">            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TABLES</span><span class="p">,</span> <span class="s1">&#39;Methane&#39;</span><span class="p">,</span> <span class="s1">&#39;pre-impoundment.yaml&#39;</span><span class="p">),</span>
</span><span id="line-586">            <span class="n">schema_file</span> <span class="o">=</span> <span class="n">get_package_file</span><span class="p">(</span><span class="s2">&quot;schemas/pre_impoundment_schema.json&quot;</span><span class="p">))</span>
</span><span id="line-587">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="line-588">            <span class="n">catchment</span><span class="o">=</span><span class="n">catchment</span><span class="p">,</span>
</span><span id="line-589">            <span class="n">reservoir</span><span class="o">=</span><span class="n">reservoir</span><span class="p">,</span>
</span><span id="line-590">            <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="line-591">            <span class="n">preinund_area</span><span class="o">=</span><span class="n">preinund_area</span><span class="p">)</span>
</span><span id="line-592">        <span class="c1"># List of parameters required for CH4 emission calculations</span>
</span><span id="line-593">        <span class="n">par_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k1_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k2_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k3_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;k4_diff&#39;</span><span class="p">,</span>
</span><span id="line-594">                    <span class="s1">&#39;k1_ebull&#39;</span><span class="p">,</span> <span class="s1">&#39;k2_ebull&#39;</span><span class="p">,</span> <span class="s1">&#39;k3_ebull&#39;</span><span class="p">,</span> <span class="s1">&#39;k1_degas&#39;</span><span class="p">,</span>
</span><span id="line-595">                    <span class="s1">&#39;k2_degas&#39;</span><span class="p">,</span> <span class="s1">&#39;k3_degas&#39;</span><span class="p">,</span> <span class="s1">&#39;k4_degas&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_CO2&#39;</span><span class="p">,</span>
</span><span id="line-596">                    <span class="s1">&#39;weight_CH4&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_C&#39;</span><span class="p">,</span> <span class="s1">&#39;ch4_gwp100&#39;</span><span class="p">,</span> <span class="s1">&#39;conv_coeff&#39;</span><span class="p">]</span>
</span><span id="line-597">        <span class="c1"># Read the parameters from config</span>
</span><span id="line-598">        <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_par_from_config</span><span class="p">(</span>
</span><span id="line-599">            <span class="n">list_of_constants</span><span class="o">=</span><span class="n">par_list</span><span class="p">,</span> <span class="n">section_name</span><span class="o">=</span><span class="s1">&#39;METHANE&#39;</span><span class="p">)</span></div>

</span><span id="line-600">
<div class="viewcode-block" id="MethaneEmission.pre_impoundment">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.pre_impoundment">[docs]</a>
</span><span id="line-601">    <span class="k">def</span> <span class="nf">pre_impoundment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_preemission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-602"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate CH$_4$ emissions from the inundated area prior to impoundment.</span>
</span><span id="line-603">
</span><span id="line-604"><span class="sd">        Uses a table of pre-impoundment emissions per land cover category</span>
</span><span id="line-605"><span class="sd">        and soil type, in kgCH$_4$/ha/yr.</span>
</span><span id="line-606">
</span><span id="line-607"><span class="sd">        Adds pre-impoundment emission from water bodies prior to impoundment.</span>
</span><span id="line-608">
</span><span id="line-609"><span class="sd">        Note:</span>
</span><span id="line-610"><span class="sd">            Pre-impoundment emissions are subtracted from the total CH$_4$ emission, comprised of the sum of degassing, ebullition and diffusion emission estimates (as CO$_2$ equivalents).</span>
</span><span id="line-611">
</span><span id="line-612"><span class="sd">        Args:</span>
</span><span id="line-613"><span class="sd">            add_preemission (bool, optional): Flag to add pre-impoundment emission from</span>
</span><span id="line-614"><span class="sd">                water bodies (default: False).</span>
</span><span id="line-615">
</span><span id="line-616"><span class="sd">        Returns:</span>
</span><span id="line-617"><span class="sd">            float: Unit pre-impoundment emission in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-618"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-619">        <span class="n">_list_of_landuses</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">list</span><span class="p">(</span><span class="n">Landuse</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_member_map_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="line-620">        <span class="n">climate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">biogenic_factors</span><span class="o">.</span><span class="n">climate</span>
</span><span id="line-621">        <span class="n">soil_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">biogenic_factors</span><span class="o">.</span><span class="n">soil_type</span>
</span><span id="line-622">        <span class="n">supported_landuses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment_table</span><span class="p">[</span><span class="s1">&#39;boreal&#39;</span><span class="p">][</span><span class="s1">&#39;mineral&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="line-623">        <span class="n">emissions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-624">        <span class="k">for</span> <span class="n">landuse</span><span class="p">,</span> <span class="n">fraction</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="line-625">                <span class="n">_list_of_landuses</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area_fractions</span><span class="p">):</span>
</span><span id="line-626">            <span class="c1"># Area in ha allocated to each landuse (reservoir.area in km2)</span>
</span><span id="line-627">            <span class="n">area_landuse</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="n">fraction</span>
</span><span id="line-628">            <span class="k">if</span> <span class="n">landuse</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_landuses</span><span class="p">:</span>
</span><span id="line-629">                <span class="k">continue</span>
</span><span id="line-630">            <span class="n">coeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment_table</span><span class="p">[</span>
</span><span id="line-631">                <span class="n">climate</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="n">soil_type</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="n">landuse</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
</span><span id="line-632">            <span class="c1"># Create a list of emissions per area fraction, in kg CH4 yr-1</span>
</span><span id="line-633">            <span class="n">emissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">area_landuse</span> <span class="o">*</span> <span class="n">coeff</span><span class="p">)</span>
</span><span id="line-634">        <span class="c1"># The below calculation assumes that the windspeed provided as an</span>
</span><span id="line-635">        <span class="c1"># Attribute to the reservoir object is at 50m height. Put this in</span>
</span><span id="line-636">        <span class="c1"># documentation or allow wind speed at different heights and addd</span>
</span><span id="line-637">        <span class="c1"># one more argument which is the windspeed measurement height.</span>
</span><span id="line-638">        <span class="k">if</span> <span class="n">add_preemission</span><span class="p">:</span>
</span><span id="line-639">            <span class="n">emissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="line-640">                <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">ch4_preemission_factor</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span>
</span><span id="line-641">                <span class="mi">100</span><span class="p">)</span>
</span><span id="line-642">        <span class="c1"># Total emission needs to be in g CO2eq m-2 yr-1.</span>
</span><span id="line-643">        <span class="c1"># To convert from CH4 to CO2</span>
</span><span id="line-644">        <span class="c1"># the unit emission is multiplied by 44/16, i.e. molecular weight</span>
</span><span id="line-645">        <span class="c1"># of CO2 divided by molecular weight of CH4.</span>
</span><span id="line-646">        <span class="c1"># To convert to CO2,eq the value is additionally multiplied by</span>
</span><span id="line-647">        <span class="c1"># the Global Warming Potential of CH4 over the reservoir&#39;s lifespan</span>
</span><span id="line-648">        <span class="c1"># (100 years). Factor of 1/1000 convert the unit from kg/km2 to g/m2.</span>
</span><span id="line-649">        <span class="n">ch4_co2_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CH4</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CO2</span>
</span><span id="line-650">        <span class="n">tot_emission</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">emissions</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="mf">1e-3</span> <span class="o">*</span> \
</span><span id="line-651">            <span class="mi">1</span><span class="o">/</span><span class="n">ch4_co2_ratio</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-652">        <span class="k">return</span> <span class="n">tot_emission</span></div>

</span><span id="line-653">
<div class="viewcode-block" id="MethaneEmission.ebullition_flux">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.ebullition_flux">[docs]</a>
</span><span id="line-654">    <span class="k">def</span> <span class="nf">ebullition_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="line-655">                        <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-656"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate CH$_4$ emission in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$ through ebullition (bubbling).</span>
</span><span id="line-657">
</span><span id="line-658"><span class="sd">        Uses G-Res CH$_4$ Bubbling Emissions equation to calculate emission for a life-span of n years defined in argument `time_horizon`.</span>
</span><span id="line-659"><span class="sd">        </span>
</span><span id="line-660"><span class="sd">        Note:</span>
</span><span id="line-661"><span class="sd">            Currently, assumes life-span of 100 years. Eq. 5 in Praire2021_.</span>
</span><span id="line-662">
</span><span id="line-663"><span class="sd">        Args:</span>
</span><span id="line-664"><span class="sd">            year (int, optional): Year for which to calculate the emission.</span>
</span><span id="line-665"><span class="sd">            time_horizon (int, optional): Time horizon in years (default: 100).</span>
</span><span id="line-666">
</span><span id="line-667"><span class="sd">        Returns:</span>
</span><span id="line-668"><span class="sd">            float: CH$_4$ emission via bubbling in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-669"><span class="sd">        </span>
</span><span id="line-670"><span class="sd">        **CH$_4$ ebullition flux equation:**</span>
</span><span id="line-671"><span class="sd">        </span>
</span><span id="line-672"><span class="sd">        .. math::</span>
</span><span id="line-673">
</span><span id="line-674"><span class="sd">            \begin{eqnarray}</span>
</span><span id="line-675"><span class="sd">            q_{CH_4, bubbling} (n) &amp; = &amp; 10^\left( k_1^{ebull} + k_2^{ebull} \, \log_{10} (f_{littoral}/100) + k_3^{ebull} \, irr_{mean} \right) \\</span>
</span><span id="line-676"><span class="sd">            &amp; &amp; \times (365/1000) \, (16/12) \, \textrm{gwp}_{CH_4}^{n}</span>
</span><span id="line-677"><span class="sd">            \end{eqnarray}</span>
</span><span id="line-678"><span class="sd">            </span>
</span><span id="line-679"><span class="sd">        where:</span>
</span><span id="line-680"><span class="sd">            * $q_{CH_4, bubbling}$ is CH$_4$ emission via bubbling, (g CO$_{2e}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-681"><span class="sd">            * $f_{littoral}$ is a littoral fraction, (\%)</span>
</span><span id="line-682"><span class="sd">            * $k_1^{ebull}, k_2^{ebull}, k_3^{ebull}$ are regression coefficients.</span>
</span><span id="line-683"><span class="sd">            * $\textrm{gwp}_{CH_4}^{n}$ is methane&#39;s Global Warming Potential over a 100 year period.</span>
</span><span id="line-684"><span class="sd">            * $16/12$ is a molecular weight ratio between CH$_4$ and C.</span>
</span><span id="line-685"><span class="sd">            * $irr_{mean}$ is reservoir&#39;s cumulative mean horizontal radiance in kWh/m$^2$/d.</span>
</span><span id="line-686"><span class="sd">        The value is divided by 1000 in order to convert from mg CO$_{2e}$ to g CO$_{2e}$.</span>
</span><span id="line-687"><span class="sd">            </span>
</span><span id="line-688"><span class="sd">        Note:</span>
</span><span id="line-689"><span class="sd">            Ebullition fluxes are not time-dependent, hence no emission profile is calculated.</span>
</span><span id="line-690"><span class="sd">            Regression statistics: n = 46, R2 = 0.26, RMSE = 0.8, Outlier = 3</span>
</span><span id="line-691"><span class="sd">            In case other life-spans are to be investigated, the global warming potential of CH$_4$ needs to be adjusted to a differnet number of years.</span>
</span><span id="line-692"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-693">        <span class="c1"># Time horizon is required to quantify GWP value, which differs</span>
</span><span id="line-694">        <span class="c1"># depending on the number of years for which global warming potential</span>
</span><span id="line-695">        <span class="c1"># is quantified.</span>
</span><span id="line-696">        <span class="k">if</span> <span class="n">time_horizon</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="line-697">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Currently, the tool supports time horizon of 100 years only.&quot;</span><span class="p">)</span>
</span><span id="line-698">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-699">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-700">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-701">        <span class="c1"># Check if the user supplied year in the arguments</span>
</span><span id="line-702">        <span class="k">if</span> <span class="n">year</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-703">            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="line-704">                <span class="s2">&quot;Ebullition is not time-dependent. year argument takes no effect.&quot;</span><span class="p">)</span>
</span><span id="line-705">        <span class="c1"># Percentage of surface area that is littoral (near the shore)</span>
</span><span id="line-706">        <span class="n">littoral_perc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">littoral_area_frac</span><span class="p">()</span>
</span><span id="line-707">        <span class="c1"># Calculate CH4 emission in mg CH4-C m-2 d-1</span>
</span><span id="line-708">        <span class="n">emission_in_ch4</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span>
</span><span id="line-709">            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k1_ebull</span>
</span><span id="line-710">            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k2_ebull</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">littoral_perc</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
</span><span id="line-711">            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k3_ebull</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">global_radiance</span><span class="p">())</span>
</span><span id="line-712">        <span class="c1"># Convert CH4 emission from mg CH4-C m-2 d-1 to g CO2eq m-2 yr-1</span>
</span><span id="line-713">        <span class="n">co2_c_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CH4</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_C</span>
</span><span id="line-714">        <span class="n">emission_in_co2</span> <span class="o">=</span> <span class="n">emission_in_ch4</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">*</span> <span class="n">co2_c_ratio</span> <span class="o">*</span> <span class="n">gwp</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1000</span>
</span><span id="line-715">        <span class="k">return</span> <span class="n">emission_in_co2</span></div>

</span><span id="line-716">
<div class="viewcode-block" id="MethaneEmission.ebullition_flux_int">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.ebullition_flux_int">[docs]</a>
</span><span id="line-717">    <span class="k">def</span> <span class="nf">ebullition_flux_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-718"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate integrated ebullition flux in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-719">
</span><span id="line-720"><span class="sd">        Calls `ebullition flux`. Since ebullition flux is not time-dependent, average ebullition</span>
</span><span id="line-721"><span class="sd">        flux per year is equal to ebullition flux (at any given time).</span>
</span><span id="line-722">
</span><span id="line-723"><span class="sd">        Args:</span>
</span><span id="line-724"><span class="sd">            time_horizon (int, optional): Time horizon in years (default: 100).</span>
</span><span id="line-725"><span class="sd">            </span>
</span><span id="line-726"><span class="sd">        **Gross (integrated) CH$_4$ ebullition flux equation:**</span>
</span><span id="line-727"><span class="sd">        </span>
</span><span id="line-728"><span class="sd">        .. math::</span>
</span><span id="line-729"><span class="sd">            </span>
</span><span id="line-730"><span class="sd">            \begin{equation}</span>
</span><span id="line-731"><span class="sd">                q_{CH_4, bubbling}^{gross} (n) = q_{CH_4, bubbling} (t=1, n)</span>
</span><span id="line-732"><span class="sd">            \end{equation}</span>
</span><span id="line-733"><span class="sd">            </span>
</span><span id="line-734"><span class="sd">        Attention:</span>
</span><span id="line-735"><span class="sd">            $q_{CH_4, bubbling}$ is not time-dependent</span>
</span><span id="line-736">
</span><span id="line-737"><span class="sd">        Returns:</span>
</span><span id="line-738"><span class="sd">            float: Integrated ebullition flux in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-739"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-740">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebullition_flux</span><span class="p">(</span><span class="n">time_horizon</span><span class="o">=</span><span class="n">time_horizon</span><span class="p">)</span></div>

</span><span id="line-741">
<div class="viewcode-block" id="MethaneEmission._ebullition_flux_profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission._ebullition_flux_profile">[docs]</a>
</span><span id="line-742">    <span class="k">def</span> <span class="nf">_ebullition_flux_profile</span><span class="p">(</span>
</span><span id="line-743">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-744">            <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> \
</span><span id="line-745">            <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-746"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts ebullition emission into a profile with points (emission</span>
</span><span id="line-747"><span class="sd">        values) defined in the argument `years`.</span>
</span><span id="line-748">
</span><span id="line-749"><span class="sd">        Attention:</span>
</span><span id="line-750"><span class="sd">            Since ebullition is not time-dependent, the output will be a list with values all equal to the ebullition value (scalar).</span>
</span><span id="line-751">
</span><span id="line-752"><span class="sd">        Args:</span>
</span><span id="line-753"><span class="sd">            years (Tuple[int, ...], optional): Vector of years for emission profile</span>
</span><span id="line-754"><span class="sd">                (default: (1, 5, 10, 20, 30, 40, 50, 100)).</span>
</span><span id="line-755">
</span><span id="line-756"><span class="sd">        Returns:</span>
</span><span id="line-757"><span class="sd">            List[float]: List of ebullition flux values in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$ corresponding to the input years.</span>
</span><span id="line-758"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-759">        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ebullition_flux_int</span><span class="p">()]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span></div>

</span><span id="line-760">
<div class="viewcode-block" id="MethaneEmission.diffusion_flux">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.diffusion_flux">[docs]</a>
</span><span id="line-761">    <span class="k">def</span> <span class="nf">diffusion_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-762"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate CH$_4$ emission via diffusion in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$ for a given year.</span>
</span><span id="line-763">
</span><span id="line-764"><span class="sd">        Note:</span>
</span><span id="line-765"><span class="sd">            Returns diffusion flux in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$ for a given year.</span>
</span><span id="line-766"><span class="sd">            Time horizon is used to select the appropriate GWP value.</span>
</span><span id="line-767"><span class="sd">            Currently, only the time horizon of 100 years is supported.</span>
</span><span id="line-768">
</span><span id="line-769"><span class="sd">        Args:</span>
</span><span id="line-770"><span class="sd">            year (float): Reservoir age in years (after impoundment).</span>
</span><span id="line-771"><span class="sd">            time_horizon (int, optional): Time horizon in years (default: 100).</span>
</span><span id="line-772">
</span><span id="line-773"><span class="sd">        Returns:</span>
</span><span id="line-774"><span class="sd">            float: Diffusion flux in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-775"><span class="sd">        </span>
</span><span id="line-776"><span class="sd">        **CH$_4$ diffusion flux equation:**</span>
</span><span id="line-777">
</span><span id="line-778"><span class="sd">        .. math::</span>
</span><span id="line-779"><span class="sd">            </span>
</span><span id="line-780"><span class="sd">            \begin{eqnarray}</span>
</span><span id="line-781"><span class="sd">            q_{CH_4, diffusion} (t, n)&amp; = &amp; 10^\left( k_1^{diff} + k_2^{diff} \, t + k_3^{diff} \log10\left(\frac{f_{littoral}}{100}\right) + k_4^{diff} T_{eff}^{CH_4} \right) \\</span>
</span><span id="line-782"><span class="sd">            &amp; &amp; \times (365/1000) \, (16/12) \, \textrm{gwp}_{CH_4}^{n}</span>
</span><span id="line-783"><span class="sd">            \end{eqnarray}</span>
</span><span id="line-784"><span class="sd">            </span>
</span><span id="line-785"><span class="sd">        where:</span>
</span><span id="line-786"><span class="sd">            * $q_{CH_4, diffusion}$ is CH$_4$ emission via diffusion, (g CO$_{2eq}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-787"><span class="sd">            * $f_{littoral}$ is a littoral fraction, (\%)</span>
</span><span id="line-788"><span class="sd">            * $n$ is the time horizon in years use to set GWP value</span>
</span><span id="line-789"><span class="sd">            * $t$ is the reservoir age (after impoundment) in years</span>
</span><span id="line-790"><span class="sd">            * $k_1^{diff}, k_2^{diff}, k_3^{diff}, k_4^{diff}$ are regression coefficients.</span>
</span><span id="line-791"><span class="sd">            * $gwp_{CH_4}^{n}$ is methane&#39;s Global Warming Potential over a n year horizon.</span>
</span><span id="line-792"><span class="sd">            * $16/12$ is a molecular weight ratio between CH$_4$ and C.</span>
</span><span id="line-793"><span class="sd">            * $T_{eff}^{CH_4}$ is the effective temperature for CH$_4$ in degC.</span>
</span><span id="line-794"><span class="sd">        The value is divided by 1000 in order to convert from mg CO$_{2e}$ to g CO$_{2e}$.</span>
</span><span id="line-795"><span class="sd">        </span>
</span><span id="line-796"><span class="sd">        Note:</span>
</span><span id="line-797"><span class="sd">            Eq. 3 in Praire2021, R2=0.51, RMSE=0.52, N=160</span>
</span><span id="line-798"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-799">
</span><span id="line-800">        <span class="c1"># Time horizon is required to quantify GWP value, which differs</span>
</span><span id="line-801">        <span class="c1"># depending on the number of years for which global warming potential</span>
</span><span id="line-802">        <span class="c1"># is quantified.</span>
</span><span id="line-803">        <span class="k">if</span> <span class="n">time_horizon</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="line-804">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Currently, the tool supports time horizon of 100 years only.&quot;</span><span class="p">)</span>
</span><span id="line-805">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-806">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-807">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-808">        <span class="c1"># Percentage of surface area that is littoral (near the shore)</span>
</span><span id="line-809">        <span class="n">littoral_perc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">littoral_area_frac</span><span class="p">()</span>
</span><span id="line-810">        <span class="c1"># Calculate effective annual temperature for CH4</span>
</span><span id="line-811">        <span class="n">eff_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">monthly_temp</span><span class="o">.</span><span class="n">eff_temp</span><span class="p">(</span><span class="n">gas</span><span class="o">=</span><span class="s1">&#39;ch4&#39;</span><span class="p">)</span>
</span><span id="line-812">        <span class="c1"># Calculate flux in gCO2eq/m2/yr</span>
</span><span id="line-813">        <span class="n">aux_var_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k2_diff</span> <span class="o">*</span> <span class="n">year</span>
</span><span id="line-814">        <span class="n">aux_var_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k3_diff</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">littoral_perc</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
</span><span id="line-815">        <span class="n">aux_var_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k4_diff</span> <span class="o">*</span> <span class="n">eff_temp</span>
</span><span id="line-816">        <span class="n">flux</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k1_diff</span> <span class="o">+</span> <span class="n">aux_var_1</span> <span class="o">+</span> <span class="n">aux_var_2</span> <span class="o">+</span> <span class="n">aux_var_3</span><span class="p">)</span> <span class="o">*</span> \
</span><span id="line-817">            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CH4</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_C</span> <span class="o">*</span> <span class="n">gwp</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">/</span> <span class="mi">1000</span>
</span><span id="line-818">        <span class="k">return</span> <span class="n">flux</span></div>

</span><span id="line-819">
<div class="viewcode-block" id="MethaneEmission.diffusion_flux_int">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.diffusion_flux_int">[docs]</a>
</span><span id="line-820">    <span class="k">def</span> <span class="nf">diffusion_flux_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-821"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-822"><span class="sd">        Calculate integrated unit (per year) CH$_4$ emission via diffusion.</span>
</span><span id="line-823">
</span><span id="line-824"><span class="sd">        Note:</span>
</span><span id="line-825"><span class="sd">            The emission is given in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$. Default time horizon of</span>
</span><span id="line-826"><span class="sd">            100 years is used. The time horizon is required for finding the global</span>
</span><span id="line-827"><span class="sd">            warming potential which itself depends on the number of years it&#39;s</span>
</span><span id="line-828"><span class="sd">            calculated for.</span>
</span><span id="line-829">
</span><span id="line-830"><span class="sd">        Args:</span>
</span><span id="line-831"><span class="sd">            time_horizon (int, optional): Time horizon in years (default: 100).</span>
</span><span id="line-832">
</span><span id="line-833"><span class="sd">        Returns:</span>
</span><span id="line-834"><span class="sd">            float: Integrated diffusion flux in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-835"><span class="sd">            </span>
</span><span id="line-836"><span class="sd">        **Gross (integrated) unit CH$_4$ emission via diffusion:**</span>
</span><span id="line-837">
</span><span id="line-838"><span class="sd">        .. math::</span>
</span><span id="line-839"><span class="sd">            </span>
</span><span id="line-840"><span class="sd">            \begin{equation}</span>
</span><span id="line-841"><span class="sd">            q_{CH_4, diffusion}^{gross} (n) = q_{CH_4, diffusion}(t=1, n) \, \frac{1-10^{(100 \, k_2^{diff})}}{-100\,\ln(10)\,k_2^{diff}}</span>
</span><span id="line-842"><span class="sd">            \end{equation}</span>
</span><span id="line-843"><span class="sd">            </span>
</span><span id="line-844"><span class="sd">        where:</span>
</span><span id="line-845"><span class="sd">            * $q_{CH_4, diffusion}$ is CH$_4$ emission via diffusion, (g CO$_{2e}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-846"><span class="sd">            * $q_{CH_4, diffusion}^{gross}$ is the unit (per time) gross CH$_4$ emission via diffusion integrated over n=100 years, (g CO$_{2e}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-847"><span class="sd">            * $t$ is the reservoir age (after impoundment) in years</span>
</span><span id="line-848"><span class="sd">            * $k_2^{diff}$ is a regression coefficients.</span>
</span><span id="line-849"><span class="sd">        </span>
</span><span id="line-850"><span class="sd">        Note:</span>
</span><span id="line-851"><span class="sd">            Eq. 4 in Praire2021.</span>
</span><span id="line-852"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-853">        <span class="n">aux1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="n">time_horizon</span><span class="p">)</span>
</span><span id="line-854">        <span class="n">flux</span> <span class="o">=</span> <span class="n">aux1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k2_diff</span><span class="o">*</span><span class="n">time_horizon</span><span class="p">))</span> <span class="o">/</span> \
</span><span id="line-855">            <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k2_diff</span><span class="o">*</span><span class="n">time_horizon</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span id="line-856">        <span class="k">return</span> <span class="n">flux</span></div>

</span><span id="line-857">
<div class="viewcode-block" id="MethaneEmission._diffusion_flux_profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission._diffusion_flux_profile">[docs]</a>
</span><span id="line-858">    <span class="k">def</span> <span class="nf">_diffusion_flux_profile</span><span class="p">(</span>
</span><span id="line-859">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-860">            <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> \
</span><span id="line-861">            <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-862"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-863"><span class="sd">        Calculate CH$_4$ emission profile for a vector of years.</span>
</span><span id="line-864">
</span><span id="line-865"><span class="sd">        Args:</span>
</span><span id="line-866"><span class="sd">            years (Tuple[int, ...], optional): Vector of years for emission profile</span>
</span><span id="line-867"><span class="sd">                (default: (1, 5, 10, 20, 30, 40, 50, 100)).</span>
</span><span id="line-868">
</span><span id="line-869"><span class="sd">        Returns:</span>
</span><span id="line-870"><span class="sd">            List[float]: List of diffusion flux values in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$ corresponding to the input years.</span>
</span><span id="line-871"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-872">        <span class="n">profile</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
</span><span id="line-873">        <span class="k">return</span> <span class="n">profile</span></div>

</span><span id="line-874">
<div class="viewcode-block" id="MethaneEmission.degassing_flux_int">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.degassing_flux_int">[docs]</a>
</span><span id="line-875">    <span class="k">def</span> <span class="nf">degassing_flux_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-876"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-877"><span class="sd">        Calculate CH$_4$ emission per year via degassing, integrated over time</span>
</span><span id="line-878"><span class="sd">        horizon given in argument `time_horizon` in years.</span>
</span><span id="line-879">
</span><span id="line-880"><span class="sd">        Note:</span>
</span><span id="line-881"><span class="sd">            Degassing emissions are computed when the hydroleclectric facility has</span>
</span><span id="line-882"><span class="sd">            a deep water draw off point \&amp; when this deep water draw off takes water</span>
</span><span id="line-883"><span class="sd">            from below the thermocline of a stratified system. For this reason,</span>
</span><span id="line-884"><span class="sd">            deep water draw off depth and thermocline depth are required for formal</span>
</span><span id="line-885"><span class="sd">            assesment of whether a degassing flux should be estimated. In general,</span>
</span><span id="line-886"><span class="sd">            neither of these two data can be reliably measured/estimated. However,</span>
</span><span id="line-887"><span class="sd">            we can assume that most new hydroelectric facilities will operate deep</span>
</span><span id="line-888"><span class="sd">            water draw offs, and at least in the tropics in deeper systems</span>
</span><span id="line-889"><span class="sd">            (&gt;10m mean depth), stratification will occur.</span>
</span><span id="line-890">
</span><span id="line-891"><span class="sd">        If water intake depth &lt; thermocline depth: :math:`q_{CH_4, degassing}^{gross} = 0`, else:</span>
</span><span id="line-892"><span class="sd">        </span>
</span><span id="line-893"><span class="sd">        .. math::</span>
</span><span id="line-894"><span class="sd">            </span>
</span><span id="line-895"><span class="sd">            \begin{eqnarray}</span>
</span><span id="line-896"><span class="sd">            q_{CH_4, degassing}^{gross} (n)&amp; = &amp; 10^{\left(k_1^{degas} + k_2^{degas}\,\log10(WRT) + k_3^{degas}\,\log10\left(q_{CH_4, diffusion}^{gross} (n)\right)\right)} \\</span>
</span><span id="line-897"><span class="sd">            &amp; &amp; \times q_{dis} \, A_{res} \, gwp_{CH_4}^{n} \, 16/12 \times 0.9 \times 10^{-6}</span>
</span><span id="line-898"><span class="sd">            \end{eqnarray}</span>
</span><span id="line-899"><span class="sd">        where:</span>
</span><span id="line-900"><span class="sd">            * $q_{CH_4, degassing}^{gross}$ is the unit (per time) gross CH$_4$ emission via degassing integrated over n=100 years, (g CO$_{2eq}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-901"><span class="sd">            * $q_{CH_4, diffusion}^{gross}$ is the unit (per time) gross CH$_4$ emission via diffusion integrated over n=100 years, (g CO$_{2eq}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-902"><span class="sd">            * $k_1^{degas}, k_2^{degas}, k_3^{degas}$ are regression coefficients.</span>
</span><span id="line-903"><span class="sd">            * $WRT$ is the water residence time in the reservoir, years.</span>
</span><span id="line-904"><span class="sd">            * $\textrm{gwp}_{CH_4}^{n}$ is methane&#39;s Global Warming Potential over a n year horizon.</span>
</span><span id="line-905"><span class="sd">            * $16/12$ is a molecular weight ratio between CH$_4$ and C.</span>
</span><span id="line-906"><span class="sd">            * $q_{dis}$ is the reservoir discharge flow in m$^3$/year.</span>
</span><span id="line-907"><span class="sd">            * $A_{res}$ is the reservoir surface area in km$^2$.</span>
</span><span id="line-908"><span class="sd">            </span>
</span><span id="line-909"><span class="sd">        Note:</span>
</span><span id="line-910"><span class="sd">            Equation 6 in Praire2021_, R2=0.68, RMSE=0.81, N=38</span>
</span><span id="line-911">
</span><span id="line-912"><span class="sd">        Args:</span>
</span><span id="line-913"><span class="sd">            time_horizon (int, optional): Time horizon in years (default: 100).</span>
</span><span id="line-914">
</span><span id="line-915"><span class="sd">        Returns:</span>
</span><span id="line-916"><span class="sd">            float: Integrated degassing flux in g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-917"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-918">        <span class="c1"># Time horizon is required to quantify GWP value, which differs</span>
</span><span id="line-919">        <span class="c1"># depending on the number of years for which global warming potential</span>
</span><span id="line-920">        <span class="c1"># is quantified.</span>
</span><span id="line-921">        <span class="k">if</span> <span class="n">time_horizon</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="line-922">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Currently, the tool supports time horizon of 100 years only.&quot;</span><span class="p">)</span>
</span><span id="line-923">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-924">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-925">            <span class="n">gwp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">ch4_gwp100</span>
</span><span id="line-926">
</span><span id="line-927">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">water_intake_depth</span> <span class="o">&gt;</span> \
</span><span id="line-928">                <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">thermocline_depth</span><span class="p">(</span>
</span><span id="line-929">                <span class="n">wind_speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">mean_monthly_windspeed</span><span class="p">):</span>
</span><span id="line-930">            <span class="c1"># CH4 conc. difference in mg CH4-C L^(-1) (or gCH4-C m^(-3))</span>
</span><span id="line-931">            <span class="n">ch4_conc_diff</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span>
</span><span id="line-932">                <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k1_degas</span>
</span><span id="line-933">                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k2_degas</span> <span class="o">*</span>
</span><span id="line-934">                <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span><span class="p">)</span>
</span><span id="line-935">                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k3_degas</span> <span class="o">*</span>
</span><span id="line-936">                <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux_int</span><span class="p">(</span><span class="n">time_horizon</span><span class="p">)))</span>
</span><span id="line-937">            <span class="c1"># CH4 outflow flux in t CH4-C yr-1</span>
</span><span id="line-938">            <span class="n">ch4_out_flux</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">ch4_conc_diff</span> <span class="o">*</span> \
</span><span id="line-939">                <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">discharge</span>
</span><span id="line-940">            <span class="c1"># Degassing flux in gCO2,eq / m2 / year</span>
</span><span id="line-941">            <span class="k">return</span> <span class="n">ch4_out_flux</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_CH4</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_C</span> <span class="o">*</span> \
</span><span id="line-942">                <span class="n">gwp</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span>
</span><span id="line-943">        <span class="k">return</span> <span class="mf">0.0</span></div>

</span><span id="line-944">
<div class="viewcode-block" id="MethaneEmission.degassing_flux">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.degassing_flux">[docs]</a>
</span><span id="line-945">    <span class="k">def</span> <span class="nf">degassing_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-946"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-947"><span class="sd">        Calculate CH$_4$ emission flux via degassing for a given year and time horizon.</span>
</span><span id="line-948"><span class="sd">        Time horizon is used to select the appropriate GWP value for methane.</span>
</span><span id="line-949"><span class="sd">        </span>
</span><span id="line-950"><span class="sd">        Note:</span>
</span><span id="line-951"><span class="sd">            The degassing emission flux is back-calculated from the gross (integrated) degassing flux and is given in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-952">
</span><span id="line-953"><span class="sd">        Args:</span>
</span><span id="line-954"><span class="sd">            year (float): Reservoir age in years (after impoundment).</span>
</span><span id="line-955"><span class="sd">            time_horizon (int, optional): Time horizon in years (default: 100).</span>
</span><span id="line-956">
</span><span id="line-957"><span class="sd">        Returns:</span>
</span><span id="line-958"><span class="sd">            float: Degassing flux in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-959"><span class="sd">            </span>
</span><span id="line-960"><span class="sd">        .. math::</span>
</span><span id="line-961"><span class="sd">            </span>
</span><span id="line-962"><span class="sd">            \begin{equation}</span>
</span><span id="line-963"><span class="sd">                q_{CH_4, degassing}(t, n) = q_{CH_4, degassing}^{init}(n) \; \exp(-k_4^{degas} \ln(10) \, t)</span>
</span><span id="line-964"><span class="sd">            \end{equation}</span>
</span><span id="line-965"><span class="sd">             </span>
</span><span id="line-966"><span class="sd">        where $q_{CH_4, degassing}^{init}(n)$ equals:</span>
</span><span id="line-967"><span class="sd">        </span>
</span><span id="line-968"><span class="sd">        .. math::</span>
</span><span id="line-969"><span class="sd">            </span>
</span><span id="line-970"><span class="sd">            \begin{equation}</span>
</span><span id="line-971"><span class="sd">                q_{CH_4, degassing}^{init}(n) = q_{CH_4, degassing}^{gross}(n) * \frac{-k_4^{degas}\,\ln(10)\,n}{1-10^{k_4^{degas}\,n}}</span>
</span><span id="line-972"><span class="sd">            \end{equation}</span>
</span><span id="line-973"><span class="sd">        where:</span>
</span><span id="line-974"><span class="sd">            * $q_{CH_4, degassing}(t, n)$ is the unit (per time) CH$_4$ emission via degassing at time t (years), (g CO$_{2e}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-975"><span class="sd">            * $q_{CH_4, degassing}^{init}(n)$ is the unit (per time) CH$_4$ emission via degassing at time t=0 years, (g CO$_{2e}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-976"><span class="sd">            * $q_{CH_4, degassing}^{gross}(n)$ is the unit (per time) gross CH$_4$ emission via degassing integrated over n=100 years, (g CO$_{2e}$ m$^{-2}$ yr$^{-1}$)</span>
</span><span id="line-977"><span class="sd">            * $k_4^{degas}\ln(10)$ is the emission decay time-constant, yr$^{-1}$.</span>
</span><span id="line-978"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-979">        <span class="k">def</span> <span class="nf">init_flux</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-980"><span class="w">            </span><span class="sd">&quot;&quot;&quot;Calculate initial degassing flux (degassing flux in year 0), g CO$_{2e}$ m$^{-2}$ yr$^{-1}$.&quot;&quot;&quot;</span>
</span><span id="line-981">            <span class="n">flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">degassing_flux_int</span><span class="p">(</span><span class="n">time_horizon</span><span class="o">=</span><span class="n">time_horizon</span><span class="p">)</span> <span class="o">*</span> \
</span><span id="line-982">                <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k4_degas</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">time_horizon</span><span class="p">)</span> <span class="o">/</span> \
</span><span id="line-983">                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">time_horizon</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k4_degas</span><span class="p">))</span>
</span><span id="line-984">            <span class="k">return</span> <span class="n">flux</span>
</span><span id="line-985">        <span class="k">return</span> <span class="n">init_flux</span><span class="p">()</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">k4_degas</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">year</span><span class="p">)</span></div>

</span><span id="line-986">
<div class="viewcode-block" id="MethaneEmission._degassing_flux_profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission._degassing_flux_profile">[docs]</a>
</span><span id="line-987">    <span class="k">def</span> <span class="nf">_degassing_flux_profile</span><span class="p">(</span>
</span><span id="line-988">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-989">            <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> \
</span><span id="line-990">            <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-991"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-992"><span class="sd">        Calculate degassing profile for a vector of years.</span>
</span><span id="line-993">
</span><span id="line-994"><span class="sd">        Args:</span>
</span><span id="line-995"><span class="sd">            years (Tuple[int, ...], optional): Vector of years for emission profile</span>
</span><span id="line-996"><span class="sd">                (default: (1, 5, 10, 20, 30, 40, 50, 100)).</span>
</span><span id="line-997">
</span><span id="line-998"><span class="sd">        Returns:</span>
</span><span id="line-999"><span class="sd">            List[float]: List of degassing flux values in gCO$_{2e} m$^{-2}$ yr$^{-1}$ corresponding to the input years.</span>
</span><span id="line-1000"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1001">        <span class="n">profile</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">degassing_flux</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
</span><span id="line-1002">        <span class="k">return</span> <span class="n">profile</span></div>

</span><span id="line-1003">
<div class="viewcode-block" id="MethaneEmission.factor">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.factor">[docs]</a>
</span><span id="line-1004">    <span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1005"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1006"><span class="sd">        Return integrated per area CH$_4$ emission in gCO$_{2e} m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-1007">
</span><span id="line-1008"><span class="sd">        Args:</span>
</span><span id="line-1009"><span class="sd">            number_of_years (int, optional): Number of years for integration (default: 100).</span>
</span><span id="line-1010">
</span><span id="line-1011"><span class="sd">        Returns:</span>
</span><span id="line-1012"><span class="sd">            float: Integrated CH$_4$ emission factor in gCO$_{2e} m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-1013"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1014">        <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="line-1015">            <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_flux_int</span><span class="p">(</span><span class="n">time_horizon</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span>
</span><span id="line-1016">            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebullition_flux_int</span><span class="p">(</span><span class="n">time_horizon</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span>
</span><span id="line-1017">            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">degassing_flux_int</span><span class="p">(</span><span class="n">time_horizon</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span>
</span><span id="line-1018">            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment</span><span class="p">())</span>
</span><span id="line-1019">        <span class="k">return</span> <span class="n">factor</span></div>

</span><span id="line-1020">
<div class="viewcode-block" id="MethaneEmission.emission_factor">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.emission_factor">[docs]</a>
</span><span id="line-1021">    <span class="k">def</span> <span class="nf">emission_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1022"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate CH$_4$ Emission Factor for Water Bodies in kg CH$_4$/ha/yr&quot;&quot;&quot;</span>
</span><span id="line-1023">        <span class="n">em_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">ch4_emission_factor</span><span class="p">(</span><span class="n">wind_height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span><span id="line-1024">        <span class="k">return</span> <span class="n">em_factor</span></div>

</span><span id="line-1025">
<div class="viewcode-block" id="MethaneEmission.profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.profile">[docs]</a>
</span><span id="line-1026">    <span class="k">def</span> <span class="nf">profile</span><span class="p">(</span>
</span><span id="line-1027">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-1028">            <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> \
</span><span id="line-1029">            <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-1030"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1031"><span class="sd">        Return emission profile of CH$_4$ in gCO$_{2e} m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-1032">
</span><span id="line-1033"><span class="sd">        Args:</span>
</span><span id="line-1034"><span class="sd">            years (Tuple[int, ...], optional): Vector of years for emission profile</span>
</span><span id="line-1035"><span class="sd">                (default: (1, 5, 10, 20, 30, 40, 50, 100)).</span>
</span><span id="line-1036">
</span><span id="line-1037"><span class="sd">        Returns:</span>
</span><span id="line-1038"><span class="sd">            List[float]: List of total CH$_4$ flux values in gCO$_{2e} m$^{-2}$ yr$^{-1}$ corresponding to the input years.</span>
</span><span id="line-1039"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1040">        <span class="n">diff_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_flux_profile</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="n">years</span><span class="p">)</span>
</span><span id="line-1041">        <span class="n">ebull_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ebullition_flux_profile</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="n">years</span><span class="p">)</span>
</span><span id="line-1042">        <span class="n">deg_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_degassing_flux_profile</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="n">years</span><span class="p">)</span>
</span><span id="line-1043">        <span class="n">pre_impound_profile</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">pre_impoundment</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
</span><span id="line-1044">        <span class="n">tot_prof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="line-1045">            <span class="p">[</span><span class="n">diff_profile</span><span class="p">,</span> <span class="n">ebull_profile</span><span class="p">,</span> <span class="n">deg_profile</span><span class="p">,</span> <span class="n">pre_impound_profile</span><span class="p">])</span>
</span><span id="line-1046">        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tot_prof</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span></div>

</span><span id="line-1047">
<div class="viewcode-block" id="MethaneEmission.total_emission_per_year">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.total_emission_per_year">[docs]</a>
</span><span id="line-1048">    <span class="k">def</span> <span class="nf">total_emission_per_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1049"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1050"><span class="sd">        Calculate total reservoir emission per year in tCO$_{2e}$ / year.</span>
</span><span id="line-1051">
</span><span id="line-1052"><span class="sd">        Args:</span>
</span><span id="line-1053"><span class="sd">            number_of_years (int, optional): Number of years for integration (default: 100).</span>
</span><span id="line-1054">
</span><span id="line-1055"><span class="sd">        Returns:</span>
</span><span id="line-1056"><span class="sd">            float: Total CH$_4$ emission per year in tCO$_{2e}$ / year.</span>
</span><span id="line-1057"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1058">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> \
</span><span id="line-1059">            <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span></div>

</span><span id="line-1060">
<div class="viewcode-block" id="MethaneEmission.total_lifetime_emission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.MethaneEmission.total_lifetime_emission">[docs]</a>
</span><span id="line-1061">    <span class="k">def</span> <span class="nf">total_lifetime_emission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1062"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1063"><span class="sd">        Calculate total reservoir emission over lifetime in ktCO$_{2e}$.</span>
</span><span id="line-1064">
</span><span id="line-1065"><span class="sd">        Args:</span>
</span><span id="line-1066"><span class="sd">            number_of_years (int, optional): Number of years for integration (default: 100).</span>
</span><span id="line-1067">
</span><span id="line-1068"><span class="sd">        Returns:</span>
</span><span id="line-1069"><span class="sd">            float: Total CH$_4$ emission per lifetime in ktCO$_{2e}$.</span>
</span><span id="line-1070"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1071">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_emission_per_year</span><span class="p">(</span>
</span><span id="line-1072">            <span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> <span class="n">number_of_years</span> <span class="o">/</span> <span class="mi">1_000</span></div>
</div>

</span><span id="line-1073">
</span><span id="line-1074">
<div class="viewcode-block" id="NitrousOxideEmission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission">[docs]</a>
</span><span id="line-1075"><span class="nd">@dataclass</span>
</span><span id="line-1076"><span class="k">class</span> <span class="nc">NitrousOxideEmission</span><span class="p">(</span><span class="n">Emission</span><span class="p">):</span>
</span><span id="line-1077"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for calculating N$_2$0 emissions from reservoirs.</span>
</span><span id="line-1078">
</span><span id="line-1079"><span class="sd">    Attributes:</span>
</span><span id="line-1080"><span class="sd">        available_models (ClassVar[Tuple[str, ...]]): Tuple of supported N2O emission models.</span>
</span><span id="line-1081"><span class="sd">        model (str): Selected N$_2$O emission model (&#39;model_1&#39;, &#39;model_2&#39;).</span>
</span><span id="line-1082"><span class="sd">        p_export_model (str): Model for calculating P export from catchments.</span>
</span><span id="line-1083"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-1084">
</span><span id="line-1085">    <span class="n">available_models</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;model_1&#39;</span><span class="p">,</span> <span class="s1">&#39;model_2&#39;</span><span class="p">)</span>
</span><span id="line-1086">    <span class="n">model</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="line-1087">    <span class="n">p_export_model</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="line-1088">
<div class="viewcode-block" id="NitrousOxideEmission.__init__">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.__init__">[docs]</a>
</span><span id="line-1089">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catchment</span><span class="p">:</span> <span class="n">Catchment</span><span class="p">,</span> <span class="n">reservoir</span><span class="p">:</span> <span class="n">Reservoir</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="line-1090">                 <span class="n">p_export_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">preinund_area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="line-1091">                 <span class="n">config_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">INI_FILE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-1092"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1093"><span class="sd">        Initializes a NitrousOxideEmission instance.</span>
</span><span id="line-1094">
</span><span id="line-1095"><span class="sd">        Args:</span>
</span><span id="line-1096"><span class="sd">            catchment (Catchment): The catchment area.</span>
</span><span id="line-1097"><span class="sd">            reservoir (Reservoir): The reservoir.</span>
</span><span id="line-1098"><span class="sd">            model (str): Selected N$_2$O emission model (&#39;model_1&#39;, &#39;model_2&#39;).</span>
</span><span id="line-1099"><span class="sd">            p_export_model (str): Model for calculating P export from catchments.</span>
</span><span id="line-1100"><span class="sd">            preinund_area (Optional[float], optional): Pre-inundation area. Defaults to None.</span>
</span><span id="line-1101"><span class="sd">            config_file (pathlib.Path, optional): Path to configuration file. Defaults to `INI_FILE`.</span>
</span><span id="line-1102"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1103">        <span class="k">if</span> <span class="n">model</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">:</span>
</span><span id="line-1104">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Model </span><span class="si">%s</span><span class="s1"> unknown. &#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="line-1105">            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Initializing with default model 1&#39;</span><span class="p">)</span>
</span><span id="line-1106">            <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;model_1&#39;</span>
</span><span id="line-1107">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">catchment</span><span class="o">=</span><span class="n">catchment</span><span class="p">,</span> <span class="n">reservoir</span><span class="o">=</span><span class="n">reservoir</span><span class="p">,</span>
</span><span id="line-1108">                         <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span> <span class="n">preinund_area</span><span class="o">=</span><span class="n">preinund_area</span><span class="p">)</span>
</span><span id="line-1109">        <span class="c1"># List of parameters required for CH4 emission calculations</span>
</span><span id="line-1110">        <span class="n">par_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nitrous_gwp100&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_O&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_P&#39;</span><span class="p">,</span> <span class="s1">&#39;weight_N&#39;</span><span class="p">]</span>
</span><span id="line-1111">        <span class="c1"># Read the parameters from config</span>
</span><span id="line-1112">        <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_par_from_config</span><span class="p">(</span>
</span><span id="line-1113">            <span class="n">list_of_constants</span><span class="o">=</span><span class="n">par_list</span><span class="p">,</span> <span class="n">section_name</span><span class="o">=</span><span class="s1">&#39;NITROUS_OXIDE&#39;</span><span class="p">)</span>
</span><span id="line-1114">        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="line-1115">        <span class="bp">self</span><span class="o">.</span><span class="n">p_export_model</span> <span class="o">=</span> <span class="n">p_export_model</span></div>

</span><span id="line-1116">
<div class="viewcode-block" id="NitrousOxideEmission._total_to_unit">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._total_to_unit">[docs]</a>
</span><span id="line-1117">    <span class="k">def</span> <span class="nf">_total_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emission</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1118"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1119"><span class="sd">        Convert emission from kgN yr$^{-1}$ to mmolN/m$^2$/yr.</span>
</span><span id="line-1120">
</span><span id="line-1121"><span class="sd">        Args:</span>
</span><span id="line-1122"><span class="sd">            emission (float): Emission in kgN yr$^{-1}$.</span>
</span><span id="line-1123">
</span><span id="line-1124"><span class="sd">        Returns:</span>
</span><span id="line-1125"><span class="sd">            float: Emission in mmolN/m$^2$/yr.</span>
</span><span id="line-1126"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1127">        <span class="k">return</span> <span class="n">emission</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span></div>

</span><span id="line-1128">
<div class="viewcode-block" id="NitrousOxideEmission._unit_to_total">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._unit_to_total">[docs]</a>
</span><span id="line-1129">    <span class="k">def</span> <span class="nf">_unit_to_total</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_emission</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1130"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1131"><span class="sd">        Convert emission from mmolN/m$^2$/yr to kgN yr$^{-1}$.</span>
</span><span id="line-1132">
</span><span id="line-1133"><span class="sd">        Args:</span>
</span><span id="line-1134"><span class="sd">            unit_emission (float): Emission in mmolN/m$^2$/yr.</span>
</span><span id="line-1135">
</span><span id="line-1136"><span class="sd">        Returns:</span>
</span><span id="line-1137"><span class="sd">            float: Emission in kgN yr$^{-1}$.</span>
</span><span id="line-1138"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1139">        <span class="k">return</span> <span class="n">unit_emission</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span></div>

</span><span id="line-1140">
<div class="viewcode-block" id="NitrousOxideEmission.tn_fixation_load">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.tn_fixation_load">[docs]</a>
</span><span id="line-1141">    <span class="k">def</span> <span class="nf">tn_fixation_load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1142"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Total N internal fixation load following the method in Maarva et al (2018).</span>
</span><span id="line-1143">
</span><span id="line-1144"><span class="sd">        Total N fixation depends on water residence time in the reservoir</span>
</span><span id="line-1145"><span class="sd">        and molar TN:TP stoichiometry. It is formulated as the \% of the</span>
</span><span id="line-1146"><span class="sd">        riverine inflow TN load using the following formula:</span>
</span><span id="line-1147">
</span><span id="line-1148"><span class="sd">        Total N fixation load [\%]:</span>
</span><span id="line-1149"><span class="sd">        </span>
</span><span id="line-1150"><span class="sd">        .. math::</span>
</span><span id="line-1151"><span class="sd">            </span>
</span><span id="line-1152"><span class="sd">            \begin{equation}</span>
</span><span id="line-1153"><span class="sd">                L_{TN,fix} = \mu \, \left[ \frac{37.2}{1 + \exp(0.5 * {TN/TP} \, - 6.877)}  \right]</span>
</span><span id="line-1154"><span class="sd">            \end{equation}</span>
</span><span id="line-1155"><span class="sd">            </span>
</span><span id="line-1156"><span class="sd">        where:</span>
</span><span id="line-1157"><span class="sd">        </span>
</span><span id="line-1158"><span class="sd">        .. math::</span>
</span><span id="line-1159"><span class="sd">            </span>
</span><span id="line-1160"><span class="sd">            \begin{equation}</span>
</span><span id="line-1161"><span class="sd">                \mu = \textrm{erf} ((WRT - 0.028) / 0.04)</span>
</span><span id="line-1162"><span class="sd">            \end{equation}</span>
</span><span id="line-1163">
</span><span id="line-1164"><span class="sd">        with residence_time (WRT) given in years</span>
</span><span id="line-1165">
</span><span id="line-1166"><span class="sd">        Note:</span>
</span><span id="line-1167"><span class="sd">            To account for uncertainties in the total N fixation load estimates,</span>
</span><span id="line-1168"><span class="sd">            a normal distribution with standard deviation of +/-10% was assumed</span>
</span><span id="line-1169"><span class="sd">            around the predicted total N fixation load values (Akbarzahdeh 2019)</span>
</span><span id="line-1170"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1171">        <span class="n">tp_load_annual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">phosphorus_load</span><span class="p">(</span>
</span><span id="line-1172">            <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_export_model</span><span class="p">)</span>  <span class="c1"># kg P / yr</span>
</span><span id="line-1173">        <span class="n">tn_load_annual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">nitrogen_load</span><span class="p">()</span>  <span class="c1"># kg N / yr</span>
</span><span id="line-1174">        <span class="n">mu_coeff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
</span><span id="line-1175">            <span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span> <span class="o">-</span> <span class="mf">0.028</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.04</span><span class="p">))</span>
</span><span id="line-1176">        <span class="c1">#  molar ratio of inflow TP and TN loads (-)</span>
</span><span id="line-1177">        <span class="n">tn_tp_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">tn_load_annual</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span><span class="p">)</span> <span class="o">/</span> \
</span><span id="line-1178">            <span class="p">(</span><span class="n">tp_load_annual</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_P</span><span class="p">)</span>
</span><span id="line-1179">        <span class="n">tn_fix_percent</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="line-1180">            <span class="mf">37.2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">tn_tp_ratio</span> <span class="o">-</span> <span class="mf">6.877</span><span class="p">)))</span> <span class="o">*</span> <span class="n">mu_coeff</span>
</span><span id="line-1181">        <span class="c1"># Calculate total internal N fixation in kg/yr</span>
</span><span id="line-1182">        <span class="k">return</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">tn_fix_percent</span> <span class="o">*</span> <span class="n">tn_load_annual</span></div>

</span><span id="line-1183">
<div class="viewcode-block" id="NitrousOxideEmission.factor">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.factor">[docs]</a>
</span><span id="line-1184">    <span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="line-1185">               <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1186"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1187"><span class="sd">        Return N$_2$O emission in gCO$_{2e}$/m$^2$/yr.</span>
</span><span id="line-1188">
</span><span id="line-1189"><span class="sd">        N$_2$O emissions are not calculated over a defined time horizon as e.g. CO2.</span>
</span><span id="line-1190"><span class="sd">        Thus, the time horizon for N$_2$O is given the number of the beast.</span>
</span><span id="line-1191">
</span><span id="line-1192"><span class="sd">        Args:</span>
</span><span id="line-1193"><span class="sd">            number_of_years (int, optional): Number of years for emission calculation. Defaults to 666.</span>
</span><span id="line-1194"><span class="sd">            mean (bool, optional): Whether to calculate the mean emission. Defaults to False.</span>
</span><span id="line-1195"><span class="sd">            model (Optional[str], optional): Specific model to use. Defaults to None.</span>
</span><span id="line-1196">
</span><span id="line-1197"><span class="sd">        Returns:</span>
</span><span id="line-1198"><span class="sd">            float: N$_2$O emission in gCO$_{2e}$/m$^2$/yr.</span>
</span><span id="line-1199"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1200">        <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="p">:</span>
</span><span id="line-1201">            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span>
</span><span id="line-1202">        <span class="k">if</span> <span class="n">model</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">:</span>
</span><span id="line-1203">            <span class="k">raise</span> <span class="n">WrongN2OModelError</span><span class="p">(</span><span class="n">permitted_models</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">)</span>
</span><span id="line-1204">        <span class="k">if</span> <span class="n">mean</span><span class="p">:</span>
</span><span id="line-1205">            <span class="n">output</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n2o_emission_m1_co2</span><span class="p">()</span> <span class="o">+</span>
</span><span id="line-1206">                            <span class="bp">self</span><span class="o">.</span><span class="n">_n2o_emission_m2_co2</span><span class="p">())</span>
</span><span id="line-1207">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-1208">            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;model_1&quot;</span><span class="p">:</span>
</span><span id="line-1209">                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2o_emission_m1_co2</span><span class="p">()</span>
</span><span id="line-1210">            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;model_2&quot;</span><span class="p">:</span>
</span><span id="line-1211">                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2o_emission_m2_co2</span><span class="p">()</span>
</span><span id="line-1212">        <span class="k">return</span> <span class="n">output</span></div>

</span><span id="line-1213">
<div class="viewcode-block" id="NitrousOxideEmission.profile">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.profile">[docs]</a>
</span><span id="line-1214">    <span class="k">def</span> <span class="nf">profile</span><span class="p">(</span>
</span><span id="line-1215">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-1216">            <span class="n">years</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">-&gt;</span> \
</span><span id="line-1217">            <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="line-1218"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1219"><span class="sd">        Return N$_2$O emission profile for the years defined in parameter years.</span>
</span><span id="line-1220"><span class="sd">        </span>
</span><span id="line-1221"><span class="sd">        Note:</span>
</span><span id="line-1222"><span class="sd">            Only done for the purpose of keeping consistency with other emissions,</span>
</span><span id="line-1223"><span class="sd">            since N$_2$O does not have an emission profile. Thus, the returned profile</span>
</span><span id="line-1224"><span class="sd">            is a straight line with values equal to the N$_2$O emission factor.</span>
</span><span id="line-1225">
</span><span id="line-1226"><span class="sd">        Args:</span>
</span><span id="line-1227"><span class="sd">            years (Tuple[int], optional): Years for the emission profile. Defaults to (1, 5, 10, 20, 30, 40, 50, 100).</span>
</span><span id="line-1228">
</span><span id="line-1229"><span class="sd">        Returns:</span>
</span><span id="line-1230"><span class="sd">            List[float]: N$_2$O emission profile for the specified years.</span>
</span><span id="line-1231"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1232">        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span></div>

</span><span id="line-1233">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_emission_m1_co2">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_emission_m1_co2">[docs]</a>
</span><span id="line-1234">    <span class="k">def</span> <span class="nf">_n2o_emission_m1_co2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1235"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate N$_2$O emission in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$ according to model 1.</span>
</span><span id="line-1236"><span class="sd">        </span>
</span><span id="line-1237"><span class="sd">        Returns:</span>
</span><span id="line-1238"><span class="sd">            float: N$_2$O emission in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-1239"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1240">        <span class="c1"># 1. Calculate total N2O emission (kgN yr-1)</span>
</span><span id="line-1241">        <span class="n">total_n2o_emission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n2o_denitrification_m1</span><span class="p">()</span> <span class="o">+</span> \
</span><span id="line-1242">            <span class="bp">self</span><span class="o">.</span><span class="n">_n2o_nitrification_m1</span><span class="p">()</span>
</span><span id="line-1243">        <span class="c1"># 2. Calculate unit total N2O emission in mmolN/m^2/yr</span>
</span><span id="line-1244">        <span class="n">unit_n2o_emission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_to_unit</span><span class="p">(</span><span class="n">total_n2o_emission</span><span class="p">)</span>
</span><span id="line-1245">        <span class="c1"># 3. Calculate emission in gCO2eq/m2/yr</span>
</span><span id="line-1246">        <span class="n">total_n2o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span> <span class="o">*</span> \
</span><span id="line-1247">            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_O</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span><span class="p">))</span> <span class="o">*</span> \
</span><span id="line-1248">            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">nitrous_gwp100</span> <span class="o">*</span> <span class="n">unit_n2o_emission</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</span><span id="line-1249">        <span class="k">return</span> <span class="n">total_n2o</span></div>

</span><span id="line-1250">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_emission_m2_co2">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_emission_m2_co2">[docs]</a>
</span><span id="line-1251">    <span class="k">def</span> <span class="nf">_n2o_emission_m2_co2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1252"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate N$_2$O emission in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$ according to model 2.</span>
</span><span id="line-1253">
</span><span id="line-1254"><span class="sd">        Returns:</span>
</span><span id="line-1255"><span class="sd">            float: N$_2$O emission in gCO$_{2e}$ m$^{-2}$ yr$^{-1}$.</span>
</span><span id="line-1256"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1257">        <span class="n">total_n2o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span> <span class="o">*</span> \
</span><span id="line-1258">            <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_O</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">weight_N</span><span class="p">))</span> <span class="o">*</span> \
</span><span id="line-1259">            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">nitrous_gwp100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit_n2o_emission_m2</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</span><span id="line-1260">        <span class="k">return</span> <span class="n">total_n2o</span></div>

</span><span id="line-1261">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_denitrification_m1">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_denitrification_m1">[docs]</a>
</span><span id="line-1262">    <span class="k">def</span> <span class="nf">_n2o_denitrification_m1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1263"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate N$_2$O emission (kgN yr$^{-1}$) from denitrification using Model 1</span>
</span><span id="line-1264">
</span><span id="line-1265"><span class="sd">        **Model 1 formula:**</span>
</span><span id="line-1266"><span class="sd">        </span>
</span><span id="line-1267"><span class="sd">        .. math::</span>
</span><span id="line-1268"><span class="sd">        </span>
</span><span id="line-1269"><span class="sd">            \begin{equation}</span>
</span><span id="line-1270"><span class="sd">            0.009 * ( \textrm{tn_catchment_load} + \textrm{tn_fixation_load} ) *</span>
</span><span id="line-1271"><span class="sd">            [0.3833 * \textrm{erf}(0.4723 * \textrm{WRT(yrs)})]</span>
</span><span id="line-1272"><span class="sd">            \end{equation}</span>
</span><span id="line-1273">
</span><span id="line-1274"><span class="sd">        Returns:</span>
</span><span id="line-1275"><span class="sd">            float: N$_2$O emission from denitrification in kgN yr$^{-1}$.</span>
</span><span id="line-1276"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1277">        <span class="n">n2o_emission_den</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="line-1278">            <span class="mf">0.009</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">nitrogen_load</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tn_fixation_load</span><span class="p">())</span>
</span><span id="line-1279">            <span class="o">*</span> <span class="p">(</span><span class="mf">0.3833</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="mf">0.4723</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span><span class="p">)))</span>
</span><span id="line-1280">        <span class="k">return</span> <span class="n">n2o_emission_den</span></div>

</span><span id="line-1281">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_nitrification_m1">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_nitrification_m1">[docs]</a>
</span><span id="line-1282">    <span class="k">def</span> <span class="nf">_n2o_nitrification_m1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1283"><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate N$_2$O emission (kgN yr$^{-1}$) from nitrification using Model 1</span>
</span><span id="line-1284">
</span><span id="line-1285"><span class="sd">        **Model 1 formula:**</span>
</span><span id="line-1286"><span class="sd">        </span>
</span><span id="line-1287"><span class="sd">        .. math::</span>
</span><span id="line-1288"><span class="sd">        </span>
</span><span id="line-1289"><span class="sd">            \begin{equation}</span>
</span><span id="line-1290"><span class="sd">            0.009 * ( \textrm{tn_catchment_load} + \textrm{tn_fixation_load} ) *</span>
</span><span id="line-1291"><span class="sd">            [0.5144 * \textrm{erf}(0.3692 * \textrm{WRT(yrs)})]</span>
</span><span id="line-1292"><span class="sd">            \end{equation}</span>
</span><span id="line-1293">
</span><span id="line-1294"><span class="sd">        Returns:</span>
</span><span id="line-1295"><span class="sd">            float: N$_2$O emission from nitrification in kgN yr$^{-1}$.</span>
</span><span id="line-1296"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1297">        <span class="n">n2o_emission_nitr</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="line-1298">            <span class="mf">0.009</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">nitrogen_load</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tn_fixation_load</span><span class="p">())</span>
</span><span id="line-1299">            <span class="o">*</span> <span class="p">(</span><span class="mf">0.5144</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="mf">0.3692</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span><span class="p">)))</span>
</span><span id="line-1300">        <span class="k">return</span> <span class="n">n2o_emission_nitr</span></div>

</span><span id="line-1301">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_emission_m2_n">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_emission_m2_n">[docs]</a>
</span><span id="line-1302">    <span class="k">def</span> <span class="nf">_n2o_emission_m2_n</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1303"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1304"><span class="sd">        Calculate total N$_2$O emission (kgN yr$^{-1}$) using Model 2.</span>
</span><span id="line-1305">
</span><span id="line-1306"><span class="sd">        This method calculates the overall N$_2$O emissions using</span>
</span><span id="line-1307"><span class="sd">        an equation that includes mechanisms to account for N$_2$O saturation.</span>
</span><span id="line-1308">
</span><span id="line-1309"><span class="sd">        Returns:</span>
</span><span id="line-1310"><span class="sd">            float: Total N$_2$O emission in kgN yr$^{-1}$.</span>
</span><span id="line-1311"><span class="sd">            </span>
</span><span id="line-1312"><span class="sd">        Note:</span>
</span><span id="line-1313"><span class="sd">            From an overall relation derived from N2O emissions</span>
</span><span id="line-1314"><span class="sd">            computed as the sum of two EF terms: N2O derived from</span>
</span><span id="line-1315"><span class="sd">            denitrification, and N2O derived from Nitrification.</span>
</span><span id="line-1316"><span class="sd">            This approach differs from N2OA above in that the derivation of the</span>
</span><span id="line-1317"><span class="sd">            equation below included mechanisms to account for N2O saturation</span>
</span><span id="line-1318"><span class="sd">            state with respect to gaseous emissions (effectively not all N2O</span>
</span><span id="line-1319"><span class="sd">            produced is assumed to be evaded), and for internal consumption of</span>
</span><span id="line-1320"><span class="sd">            N2O produced by denitrification, which increases as a function of</span>
</span><span id="line-1321"><span class="sd">            water residence time.</span>
</span><span id="line-1322"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1323">        <span class="n">n2o_emission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">nitrogen_load</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="line-1324">            <span class="mf">0.002277</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="mf">1.63</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span><span class="p">))</span>
</span><span id="line-1325">        <span class="k">return</span> <span class="n">n2o_emission</span></div>

</span><span id="line-1326">
<div class="viewcode-block" id="NitrousOxideEmission._unit_n2o_emission_m2">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._unit_n2o_emission_m2">[docs]</a>
</span><span id="line-1327">    <span class="k">def</span> <span class="nf">_unit_n2o_emission_m2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1328"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1329"><span class="sd">        Calculate unit total N$_2$O emission in mmolN/m$^2$/yr using Model 2.</span>
</span><span id="line-1330">
</span><span id="line-1331"><span class="sd">        Returns:</span>
</span><span id="line-1332"><span class="sd">            float: Unit N$_2$O/yr.</span>
</span><span id="line-1333"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1334">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n2o_emission_m2_n</span><span class="p">())</span></div>

</span><span id="line-1335">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_denitrification_m2">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_denitrification_m2">[docs]</a>
</span><span id="line-1336">    <span class="k">def</span> <span class="nf">_n2o_denitrification_m2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1337"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1338"><span class="sd">        Calculate N$_2$O emission from denitrification in kgN/yr using Model 2.</span>
</span><span id="line-1339">
</span><span id="line-1340"><span class="sd">        Returns:</span>
</span><span id="line-1341"><span class="sd">            float: N$_2$O emission from denitrification in kgN/yr.</span>
</span><span id="line-1342"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1343">        <span class="c1"># Calculate unit N2O emission from denitfication in mmol N m-2 yr-1</span>
</span><span id="line-1344">        <span class="n">unit_n2o_denitrification</span> <span class="o">=</span> <span class="mf">0.7789</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
</span><span id="line-1345">            <span class="o">-</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span> <span class="o">+</span> <span class="mf">1.366</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.751</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> \
</span><span id="line-1346">            <span class="bp">self</span><span class="o">.</span><span class="n">_unit_n2o_emission_m2</span><span class="p">()</span>
</span><span id="line-1347">        <span class="c1"># Return N2O emission in kgN/yr</span>
</span><span id="line-1348">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit_to_total</span><span class="p">(</span><span class="n">unit_n2o_denitrification</span><span class="p">)</span></div>

</span><span id="line-1349">
<div class="viewcode-block" id="NitrousOxideEmission._n2o_nitrification_m2">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission._n2o_nitrification_m2">[docs]</a>
</span><span id="line-1350">    <span class="k">def</span> <span class="nf">_n2o_nitrification_m2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1351"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1352"><span class="sd">        Calculate N$_2$O emission from nitrification in kgN/yr using Model 2.</span>
</span><span id="line-1353">
</span><span id="line-1354"><span class="sd">        Returns:</span>
</span><span id="line-1355"><span class="sd">            float: N$_2$O emission from nitrification in kgN/yr.</span>
</span><span id="line-1356"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1357">        <span class="n">unit_n2o_nitrification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit_n2o_emission_m2</span><span class="p">()</span> <span class="o">-</span> \
</span><span id="line-1358">            <span class="bp">self</span><span class="o">.</span><span class="n">_total_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n2o_denitrification_m2</span><span class="p">())</span>
</span><span id="line-1359">        <span class="c1"># Return N2O emission in kgN/yr</span>
</span><span id="line-1360">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit_to_total</span><span class="p">(</span><span class="n">unit_n2o_nitrification</span><span class="p">)</span></div>

</span><span id="line-1361">
</span><span id="line-1362">    <span class="c1"># Additional methods calculating effluent nitrogen load and concentration</span>
</span><span id="line-1363">    <span class="c1"># from the reservoir associated with the calculated N2O emission</span>
<div class="viewcode-block" id="NitrousOxideEmission.nitrogen_downstream_load">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.nitrogen_downstream_load">[docs]</a>
</span><span id="line-1364">    <span class="k">def</span> <span class="nf">nitrogen_downstream_load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1365"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1366"><span class="sd">        Calculate downstream TN load in kgN/yr.</span>
</span><span id="line-1367">
</span><span id="line-1368"><span class="sd">        Returns:</span>
</span><span id="line-1369"><span class="sd">            float: Downstream TN load in kgN/yr.</span>
</span><span id="line-1370"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1371">        <span class="c1"># 1. Calculate TN burial as a factor of input TN</span>
</span><span id="line-1372">        <span class="n">tn_burial_factor</span> <span class="o">=</span> <span class="mf">0.51</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span>
</span><span id="line-1373">            <span class="mf">0.4723</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span><span class="p">)</span>
</span><span id="line-1374">        <span class="c1"># 2. Calculate TN denitrification as a factor of input TN</span>
</span><span id="line-1375">        <span class="n">tn_denitr_factor</span> <span class="o">=</span> <span class="mf">0.3833</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span>
</span><span id="line-1376">            <span class="mf">0.4723</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">residence_time</span><span class="p">)</span>
</span><span id="line-1377">        <span class="c1"># 3. Calculate TN loading (catchment + fixation) in kg N yr-1</span>
</span><span id="line-1378">        <span class="n">tn_loading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">nitrogen_load</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tn_fixation_load</span><span class="p">()</span>
</span><span id="line-1379">        <span class="c1"># 4. Calculate TN burial in kg N yr-1</span>
</span><span id="line-1380">        <span class="n">tn_burial</span> <span class="o">=</span> <span class="n">tn_burial_factor</span> <span class="o">*</span> <span class="n">tn_loading</span>
</span><span id="line-1381">        <span class="c1"># 5. Calculate TN denitrification in kg N yr-1</span>
</span><span id="line-1382">        <span class="n">tn_denitr</span> <span class="o">=</span> <span class="n">tn_denitr_factor</span> <span class="o">*</span> <span class="n">tn_loading</span>
</span><span id="line-1383">        <span class="c1"># 6. Calculate TN downstream load in kg N yr-1</span>
</span><span id="line-1384">        <span class="n">tn_downstream_load</span> <span class="o">=</span> <span class="n">tn_loading</span> <span class="o">-</span> <span class="n">tn_burial</span> <span class="o">-</span> <span class="n">tn_denitr</span>
</span><span id="line-1385">        <span class="k">return</span> <span class="n">tn_downstream_load</span></div>

</span><span id="line-1386">
<div class="viewcode-block" id="NitrousOxideEmission.nitrogen_downstream_conc">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.nitrogen_downstream_conc">[docs]</a>
</span><span id="line-1387">    <span class="nd">@save_return</span><span class="p">(</span><span class="n">internal</span><span class="p">,</span> <span class="n">internals_config</span><span class="p">[</span><span class="s1">&#39;nitrogen_downstream_conc&#39;</span><span class="p">][</span><span class="s1">&#39;include&#39;</span><span class="p">])</span>
</span><span id="line-1388">    <span class="k">def</span> <span class="nf">nitrogen_downstream_conc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1389"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1390"><span class="sd">        Calculate downstream TN concentration in mgN/L (gN/m$^3$).</span>
</span><span id="line-1391">
</span><span id="line-1392"><span class="sd">        Returns:</span>
</span><span id="line-1393"><span class="sd">            float: Downstream TN concentration in mgN/L (gN/m$^3$).</span>
</span><span id="line-1394"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1395">        <span class="k">return</span> <span class="mf">1e03</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nitrogen_downstream_load</span><span class="p">()</span> <span class="o">/</span> \
</span><span id="line-1396">            <span class="bp">self</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">discharge</span></div>

</span><span id="line-1397">
<div class="viewcode-block" id="NitrousOxideEmission.total_emission_per_year">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.total_emission_per_year">[docs]</a>
</span><span id="line-1398">    <span class="k">def</span> <span class="nf">total_emission_per_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1399"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1400"><span class="sd">        Calculate total reservoir emission per year in tCO$_{2e}$/year.</span>
</span><span id="line-1401">
</span><span id="line-1402"><span class="sd">        Args:</span>
</span><span id="line-1403"><span class="sd">            number_of_years (int, optional): Number of years for emission calculation. Defaults to 100.</span>
</span><span id="line-1404">
</span><span id="line-1405"><span class="sd">        Returns:</span>
</span><span id="line-1406"><span class="sd">            float: Total reservoir emission per year in tCO$_{2e}$/year.</span>
</span><span id="line-1407"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1408">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> \
</span><span id="line-1409">            <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">area</span></div>

</span><span id="line-1410">
<div class="viewcode-block" id="NitrousOxideEmission.total_lifetime_emission">
<a class="viewcode-back" href="../../api/reemission.emissions.html#reemission.emissions.NitrousOxideEmission.total_lifetime_emission">[docs]</a>
</span><span id="line-1411">    <span class="k">def</span> <span class="nf">total_lifetime_emission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_of_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="line-1412"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-1413"><span class="sd">        Calculate total reservoir emission per lifetime in ktCO$_{2e}$.</span>
</span><span id="line-1414">
</span><span id="line-1415"><span class="sd">        Args:</span>
</span><span id="line-1416"><span class="sd">            number_of_years (int, optional): Number of years for emission calculation. Defaults to 100.</span>
</span><span id="line-1417">
</span><span id="line-1418"><span class="sd">        Returns:</span>
</span><span id="line-1419"><span class="sd">            float: Total reservoir emission per lifetime in ktCO$_{2e}$.</span>
</span><span id="line-1420"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-1421">
</span><span id="line-1422">        <span class="c1"># Dummy call so that the internal variable can be saved</span>
</span><span id="line-1423">        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nitrogen_downstream_conc</span><span class="p">()</span>
</span><span id="line-1424">
</span><span id="line-1425">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_emission_per_year</span><span class="p">(</span>
</span><span id="line-1426">            <span class="n">number_of_years</span><span class="o">=</span><span class="n">number_of_years</span><span class="p">)</span> <span class="o">*</span> <span class="n">number_of_years</span> <span class="o">/</span> <span class="mi">1_000</span></div>
</div>

</span></code></pre></div>
    </div><div class="flex justify-between items-center pt-6 mt-12 border-t border-border gap-4">
</div></div>
        </main>
      </div>
    </div><footer class="py-6 border-t border-border md:py-0">
    <div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
      <div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
        <p class="text-sm leading-loose text-center text-muted-foreground md:text-left">Â© 2024, Tomasz Janus, University of Manchester, United Kingdom&nbsp;Built with <a class="font-medium underline underline-offset-4"
    href="https://www.sphinx-doc.org"
    rel="noreferrer">Sphinx 7.3.7</a></p>
</div>
</div>
</footer>
  </div>
  
    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/toggleprompt.js?v=5801b3bb"></script>
    <script src="../../_static/tabs.js?v=3030b3cb"></script>
    <script defer="defer" src="../../_static/theme.js?v=e82a16a3"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
  
</body>
</html>