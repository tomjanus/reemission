<!DOCTYPE html>
<html lang="en"
      data-content_root="../../../"
      x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }"
      x-init="$watch('darkMode', val => localStorage.setItem('darkMode', val))"
      class="scroll-smooth"
      :class="{'dark': darkMode === 'dark' || (darkMode === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)}"
>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="utf-8" />
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="white" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="black" />
  
    <title>reemission.salib.runners | ReEmission 1.0.0 documentation</title>
    <meta property="og:title" content="reemission.salib.runners | ReEmission 1.0.0 documentation" />
    <meta name="twitter:title" content="reemission.salib.runners | ReEmission 1.0.0 documentation" />
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=1949e874" />
      <link rel="stylesheet" type="text/css" href="../../../_static/theme.css?v=42baaae4" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="search" title="Search" href="../../../search.html" />
        <link rel="index" title="Index" href="../../../genindex.html" />

    <script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
  <body x-data="{ showSidebar: false, showScrollTop: false }" class="min-h-screen font-sans antialiased bg-background text-foreground" :class="{ 'overflow-hidden': showSidebar }">
    <div x-cloak x-show="showSidebar" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" @click.self="showSidebar = false"></div><div id="page" class="relative flex flex-col min-h-screen"><a href="#content" class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100">
      Skip to content
    </a><header
  class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
    <div class="hidden mr-4 md:flex">
      <a href="../../../index.html" class="flex items-center mr-6"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">ReEmission 1.0.0 documentation</span>
      </a></div><button
      class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden"
      type="button" @click="showSidebar = true">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" aria-hidden="true"
        fill="currentColor">
        <path
          d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z" />
      </svg>
      <span class="sr-only">Toggle navigation menu</span>
    </button>
    <div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
      <div class="flex-1 w-full md:w-auto md:flex-none"><form id="searchbox"
      action="../../../search.html"
      method="get"
      class="relative flex items-center group"
      @keydown.k.window.meta="$refs.search.focus()">
  <input x-ref="search"
          name="q"
          id="search-input"
          type="search"
          aria-label="Search the docs"
          placeholder="Search ..."
          class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" />
  <kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
    <span class="text-xs">âŒ˜</span>
    K
  </kbd>
</form>
      </div>
      <nav class="flex items-center space-x-1">
        <button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'"
          class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9"
          type="button"
          aria-label="Color theme switcher">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
            class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0">
            <path
              d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z" />
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
            class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100">
            <path
              d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z" />
          </svg>
        </button>
      </nav>
    </div>
  </div>
</header>

    <div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside id="left-sidebar"
  class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky"
  :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }">

    <a href="../../../index.html" class="!justify-start text-sm md:!hidden bg-background"><span class="font-bold text-clip whitespace-nowrap">ReEmission 1.0.0 documentation</span>
    </a>

    <div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
      <div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">About the Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory.html">Theoretical Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/install_package.html">Installing RE-Emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/using_docker.html">About Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/building_image.html">Building the ReEmission Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/using_image.html">Using the ReEmission Docker Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../running_docker.html">Running the ReEmission Docker Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../demo.html">Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../json.html">JSON file format description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reporting.html">Reporting Calculation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualisation.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../geocaret_integration.html">Integration with GeoCARET</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/reemission.html">Python API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.model.html">Model (Main)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.input.html">Input Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.reservoir.html">Reservoir Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.catchment.html">Catchment Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.ns_catchment.html">Post-impoundment catchment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.emissions.html">Emissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.emission_profile.html">Emission Profile Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.temperature.html">MonthlyTemperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.biogenic.html">Biogenic Factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.presenter.html">Presenter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.utils.html">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.auxiliary.html">Auxiliary functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.constants.html">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.mixins.html">Mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.document_compiler.html">Document <span class="math notranslate nohighlight">\(\LaTeX\)</span> Compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.exceptions.html">Custom Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.app_logger.html">App Logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.download.html">External Data Downloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.globals.html">Global variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.main.html">Main</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.salib.html">SALib Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/reemission.postprocessing.html">Postprocessing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

</nav>
      </div>
    </div>
    <button type="button" @click="showSidebar = false"
      class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
        stroke="none" class="h-4 w-4">
        <path
          d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z" />
      </svg>
    </button>
  </aside>
        <main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs"
     class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
  <a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground"
     href="../../../index.html">
    <span class="hidden md:inline">ReEmission 1.0.0 documentation</span>
    <svg xmlns="http://www.w3.org/2000/svg"
         height="18"
         width="18"
         viewBox="0 96 960 960"
         aria-label="Home"
         fill="currentColor"
         stroke="none"
         class="md:hidden">
      <path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z" />
    </svg>
  </a>
  
<div class="mr-1">/</div><a class="hover:text-foreground overflow-hidden text-ellipsis whitespace-nowrap"
       href="../../index.html">Module code</a>
    
<div class="mr-1">/</div><span aria-current="page"
        class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">reemission.salib.runners</span>
</nav>

    <div id="content" role="main">
      <h1>Source code for reemission.salib.runners</h1><div class="highlight"><pre>
<span></span><code><span id="line-1"><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="line-2"><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="line-3"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="line-4">    <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">Literal</span><span class="p">,</span> <span class="n">TypeAlias</span><span class="p">)</span>
</span><span id="line-6"><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>
</span><span id="line-7"><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
</span><span id="line-8"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="line-9"><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NDArray</span>
</span><span id="line-10"><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>
</span><span id="line-11"><span class="kn">from</span><span class="w"> </span><span class="nn">SALib.analyze</span><span class="w"> </span><span class="kn">import</span> <span class="n">sobol</span>
</span><span id="line-12"><span class="kn">from</span><span class="w"> </span><span class="nn">SALib.util.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResultDict</span>
</span><span id="line-13"><span class="kn">from</span><span class="w"> </span><span class="nn">SALib.sample.sobol</span><span class="w"> </span><span class="kn">import</span> <span class="n">sample</span> <span class="k">as</span> <span class="n">sobol_sample</span>
</span><span id="line-14"><span class="kn">from</span><span class="w"> </span><span class="nn">reemission.salib.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="line-15">    <span class="n">Variable</span><span class="p">,</span> <span class="n">DistributionType</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">,</span> <span class="n">DiscreteNormalDistribution</span><span class="p">,</span>
</span><span id="line-16">    <span class="n">DiscreteUniformDistribution</span><span class="p">,</span> <span class="n">UniformDistribution</span><span class="p">)</span>
</span><span id="line-17"><span class="kn">from</span><span class="w"> </span><span class="nn">reemission.salib.wrappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SALibModelWrapperProtocol</span>
</span><span id="line-18">
</span><span id="line-19">
</span><span id="line-20"><span class="n">NumpyValue</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;NumpyValue&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
</span><span id="line-21"><span class="n">Numerical</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;Numerical&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="line-22"><span class="n">SALibModel</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">NumpyValue</span><span class="p">]</span> <span class="o">|</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Numerical</span><span class="p">]],</span> <span class="n">NumpyValue</span> <span class="o">|</span> <span class="n">Numerical</span><span class="p">]</span>
</span><span id="line-23"><span class="n">ModelInputsType</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;ModelInputsType&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Variable</span><span class="p">])</span>
</span><span id="line-24"><span class="n">FixedVarName</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="line-25"><span class="n">ScenarioName</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="line-26"><span class="n">SobolIndexName</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;ST&#39;</span><span class="p">]</span>
</span><span id="line-27"><span class="n">GroupName</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="line-28">
</span><span id="line-29">
<div class="viewcode-block" id="VarianceContributions">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.VarianceContributions">[docs]</a>
</span><span id="line-30"><span class="nd">@dataclass</span>
</span><span id="line-31"><span class="k">class</span><span class="w"> </span><span class="nc">VarianceContributions</span><span class="p">:</span>
</span><span id="line-32"><span class="w">    </span><span class="sd">&quot;&quot;&quot; A dataclass to hold variances for each scenario storing contributions of variable groups</span>
</span><span id="line-33"><span class="sd">    to total variance.</span>
</span><span id="line-34"><span class="sd">    </span>
</span><span id="line-35"><span class="sd">    Attributes:</span>
</span><span id="line-36"><span class="sd">        sobol_index: The Sobol index type (e.g., &#39;S1&#39;, &#39;S2&#39;, &#39;ST&#39;) used for estimating variance</span>
</span><span id="line-37"><span class="sd">            contributions to total variance from each variable group.</span>
</span><span id="line-38"><span class="sd">        total_variance: The total variance of the output for this scenario.</span>
</span><span id="line-39"><span class="sd">        contributions_by_group: A dictionary mapping group names to their contributions to the total variance.</span>
</span><span id="line-40"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-41">    <span class="n">sobol_index</span><span class="p">:</span> <span class="n">SobolIndexName</span>
</span><span id="line-42">    <span class="n">total_variance</span><span class="p">:</span> <span class="n">Numerical</span>
</span><span id="line-43">    <span class="n">contributions_by_group</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">Numerical</span><span class="p">]</span>
</span><span id="line-44">
<div class="viewcode-block" id="VarianceContributions.__post_init__">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.VarianceContributions.__post_init__">[docs]</a>
</span><span id="line-45">    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-46"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Post-initialization to validate the Sobol index.</span>
</span><span id="line-47"><span class="sd">        Raises:</span>
</span><span id="line-48"><span class="sd">            ValueError: If the Sobol index is not one of the supported indices (&#39;S1&#39;, &#39;S2&#39;, &#39;ST&#39;).</span>
</span><span id="line-49"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-50">        <span class="n">supported_sobol_indices</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;ST&#39;</span><span class="p">)</span>
</span><span id="line-51">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sobol_index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_sobol_indices</span><span class="p">:</span>
</span><span id="line-52">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="line-53">                <span class="sa">f</span><span class="s2">&quot;Sobol index must be: </span><span class="si">{</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">supported_sobol_indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sobol_index</span><span class="si">}</span><span class="s2"> given.&quot;</span><span class="p">)</span></div>

</span><span id="line-54">
<div class="viewcode-block" id="VarianceContributions.to_dict">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.VarianceContributions.to_dict">[docs]</a>
</span><span id="line-55">    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="line-56"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the `VarianceContributions` instance to a dictionary.&quot;&quot;&quot;</span>
</span><span id="line-57">        <span class="k">return</span> <span class="p">{</span>
</span><span id="line-58">            <span class="s1">&#39;Sobol Index&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sobol_index</span><span class="p">,</span>
</span><span id="line-59">            <span class="s1">&#39;total_variance&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_variance</span><span class="p">,</span>
</span><span id="line-60">            <span class="s1">&#39;contributions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">contributions_by_group</span>
</span><span id="line-61">        <span class="p">}</span></div>
</div>

</span><span id="line-62">
</span><span id="line-63">
<div class="viewcode-block" id="SobolScenarioResults">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolScenarioResults">[docs]</a>
</span><span id="line-64"><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="line-65"><span class="k">class</span><span class="w"> </span><span class="nc">SobolScenarioResults</span><span class="p">:</span>
</span><span id="line-66"><span class="w">    </span><span class="sd">&quot;&quot;&quot; A class to hold the results of Sobol sensitivity analysis for multiple scenarios.</span>
</span><span id="line-67"><span class="sd">    Attributes:</span>
</span><span id="line-68"><span class="sd">        results: A list of SobolResults for each scenario.</span>
</span><span id="line-69"><span class="sd">        sc_names: A list of scenario names.</span>
</span><span id="line-70"><span class="sd">        ix_to_name: A mapping from scenario index to scenario name.</span>
</span><span id="line-71"><span class="sd">        </span>
</span><span id="line-72"><span class="sd">    NOTE: This class is used to hold the results of Sobol sensitivity analysis for multiple</span>
</span><span id="line-73"><span class="sd">    scenarios, where each scenario can fix some variables to specific values.</span>
</span><span id="line-74"><span class="sd">    It contains a list of SobolResults for each scenario and a list of VarianceContributions</span>
</span><span id="line-75"><span class="sd">    for each scenario, which holds the total variance and contributions of each group to</span>
</span><span id="line-76"><span class="sd">    the total variance.</span>
</span><span id="line-77"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-78">
</span><span id="line-79">    <span class="n">results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SobolResults</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="line-80">    <span class="n">sc_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="line-81">    <span class="n">ix_to_name</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="line-82">    
</span><span id="line-83">    <span class="nd">@property</span>
</span><span id="line-84">    <span class="k">def</span><span class="w"> </span><span class="nf">var_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="line-85"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the variable names for the scenarios. &quot;&quot;&quot;</span>
</span><span id="line-86">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">var_names</span>
</span><span id="line-87">    
</span><span id="line-88">    <span class="nd">@property</span>
</span><span id="line-89">    <span class="k">def</span><span class="w"> </span><span class="nf">variances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">VarianceContributions</span><span class="p">]:</span>
</span><span id="line-90"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Contributions of variable groups to total variance&quot;&quot;&quot;</span>
</span><span id="line-91">        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">variance_contributions</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">]</span>
</span><span id="line-92">    
</span><span id="line-93">    <span class="nd">@property</span>
</span><span id="line-94">    <span class="k">def</span><span class="w"> </span><span class="nf">scenario_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="line-95"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the scenario names for the Sobol results.&quot;&quot;&quot;</span>
</span><span id="line-96">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sc_names</span>
</span><span id="line-97">    
</span><span id="line-98">    <span class="nd">@property</span>
</span><span id="line-99">    <span class="k">def</span><span class="w"> </span><span class="nf">group_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="line-100"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the group names for the Sobol results.&quot;&quot;&quot;</span>
</span><span id="line-101">        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grouped_indices</span><span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="line-102">    
</span><span id="line-103">    <span class="nd">@property</span>
</span><span id="line-104">    <span class="k">def</span><span class="w"> </span><span class="nf">nominal_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Numerical</span><span class="p">]:</span>
</span><span id="line-105"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the nominal outputs for each scenario. &quot;&quot;&quot;</span>
</span><span id="line-106">        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">nominal_output</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">]</span>
</span><span id="line-107">    
<div class="viewcode-block" id="SobolScenarioResults.__post_init__">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolScenarioResults.__post_init__">[docs]</a>
</span><span id="line-108">    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-109"><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="line-110">        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span>
</span><span id="line-111">            <span class="bp">self</span><span class="p">,</span> 
</span><span id="line-112">            <span class="s2">&quot;ix_to_name&quot;</span><span class="p">,</span> 
</span><span id="line-113">            <span class="p">{</span><span class="n">ix</span><span class="p">:</span> <span class="n">scenario_name</span> <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">scenario_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sc_names</span><span class="p">)})</span></div>
</div>

</span><span id="line-114">
</span><span id="line-115">
<div class="viewcode-block" id="SobolResults">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolResults">[docs]</a>
</span><span id="line-116"><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="line-117"><span class="k">class</span><span class="w"> </span><span class="nc">SobolResults</span><span class="p">:</span>
</span><span id="line-118"><span class="w">    </span><span class="sd">&quot;&quot;&quot; A class to hold the results of Sobol sensitivity analysis.</span>
</span><span id="line-119"><span class="sd">    Attributes:</span>
</span><span id="line-120"><span class="sd">        outputs: The model outputs for the Sobol samples.</span>
</span><span id="line-121"><span class="sd">        nominal_output: The model output for the nominal input.</span>
</span><span id="line-122"><span class="sd">        indices: A dictionary containing Sobol indices (first-order, second-order, total effect).</span>
</span><span id="line-123"><span class="sd">        var_names: A list of variable names corresponding to the Sobol indices.</span>
</span><span id="line-124"><span class="sd">        grouped_indices: A dictionary containing grouped Sobol indices by variable groups.</span>
</span><span id="line-125"><span class="sd">        variance_contributions: Optional VarianceContributions for the total variance and contributions.</span>
</span><span id="line-126"><span class="sd">    Raises:</span>
</span><span id="line-127"><span class="sd">        ValueError: If the indices do not contain the expected keys.</span>
</span><span id="line-128"><span class="sd">    Usage:</span>
</span><span id="line-129"><span class="sd">        &gt;&gt;&gt; from utils.salib import SobolResults</span>
</span><span id="line-130"><span class="sd">        &gt;&gt;&gt; from utils.distributions import Variable, NormalDistribution</span>
</span><span id="line-131"><span class="sd">        &gt;&gt;&gt; outputs = np.array([1.0, 2.0, 3.0])</span>
</span><span id="line-132"><span class="sd">        &gt;&gt;&gt; nominal_output = 2.0</span>
</span><span id="line-133"><span class="sd">        &gt;&gt;&gt; indices = {</span>
</span><span id="line-134"><span class="sd">        ...     &#39;S1&#39;: [0.1, 0.2, 0.3],</span>
</span><span id="line-135"><span class="sd">        ...     &#39;S2&#39;: [0.05, 0.1, 0.15],</span>
</span><span id="line-136"><span class="sd">        ...     &#39;ST&#39;: [0.2, 0.3, 0.4]</span>
</span><span id="line-137"><span class="sd">        ... }</span>
</span><span id="line-138"><span class="sd">        &gt;&gt;&gt; var_names = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
</span><span id="line-139"><span class="sd">        &gt;&gt;&gt; sobol_results = SobolResults(</span>
</span><span id="line-140"><span class="sd">        ...     outputs=outputs,</span>
</span><span id="line-141"><span class="sd">        ...     nominal_output=nominal_output,</span>
</span><span id="line-142"><span class="sd">        ...     indices=indices,</span>
</span><span id="line-143"><span class="sd">        ...     var_names=var_names</span>
</span><span id="line-144"><span class="sd">        ... )</span>
</span><span id="line-145"><span class="sd">        &gt;&gt;&gt; print(sobol_results.first_order)  # Output: [0.1, 0.2, 0.3]</span>
</span><span id="line-146"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-147">    <span class="n">outputs</span><span class="p">:</span> <span class="n">NDArray</span>
</span><span id="line-148">    <span class="n">nominal_output</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
</span><span id="line-149">    <span class="n">indices</span><span class="p">:</span> <span class="n">ResultDict</span>
</span><span id="line-150">    <span class="n">var_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="line-151">    <span class="n">fixed_var_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="line-152">    <span class="n">grouped_indices</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ResultDict</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="line-153">        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span>
</span><span id="line-154">    <span class="n">variance_contributions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VarianceContributions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="line-155">    
</span><span id="line-156">    <span class="nd">@property</span>
</span><span id="line-157">    <span class="k">def</span><span class="w"> </span><span class="nf">first_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Numerical</span><span class="p">]:</span>
</span><span id="line-158"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the first-order Sobol indices. &quot;&quot;&quot;</span>
</span><span id="line-159">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">]</span>
</span><span id="line-160">    
</span><span id="line-161">    <span class="nd">@property</span>
</span><span id="line-162">    <span class="k">def</span><span class="w"> </span><span class="nf">second_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Numerical</span><span class="p">]:</span>
</span><span id="line-163"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the second-order Sobol indices. &quot;&quot;&quot;</span>
</span><span id="line-164">        <span class="k">if</span> <span class="s1">&#39;S2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
</span><span id="line-165">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="s1">&#39;S2&#39;</span><span class="p">]</span>
</span><span id="line-166">        <span class="k">return</span> <span class="p">[]</span>
</span><span id="line-167">    
</span><span id="line-168">    <span class="nd">@property</span>
</span><span id="line-169">    <span class="k">def</span><span class="w"> </span><span class="nf">fixed_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="line-170"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the names of fixed variables if any are defined.&quot;&quot;&quot;</span>
</span><span id="line-171">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_var_names</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_var_names</span> <span class="k">else</span> <span class="p">[]</span>
</span><span id="line-172">    
</span><span id="line-173">    <span class="nd">@property</span>
</span><span id="line-174">    <span class="k">def</span><span class="w"> </span><span class="nf">total_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Numerical</span><span class="p">]:</span>
</span><span id="line-175"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the total effect Sobol indices. &quot;&quot;&quot;</span>
</span><span id="line-176">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="s1">&#39;ST&#39;</span><span class="p">]</span>
</span><span id="line-177">    
</span><span id="line-178">    <span class="nd">@property</span>
</span><span id="line-179">    <span class="k">def</span><span class="w"> </span><span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="line-180"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-181"><span class="sd">        Return the group names from the first entry in grouped_indices,</span>
</span><span id="line-182"><span class="sd">        or an empty list if grouped_indices is empty.</span>
</span><span id="line-183"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-184">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">grouped_indices</span><span class="p">:</span>
</span><span id="line-185">            <span class="k">return</span> <span class="p">[]</span>
</span><span id="line-186">        <span class="c1"># Get the first key in grouped_indices</span>
</span><span id="line-187">        <span class="n">first_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouped_indices</span><span class="p">))</span>
</span><span id="line-188">        <span class="c1"># Return the keys of the dictionary belonging to the first key</span>
</span><span id="line-189">        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grouped_indices</span><span class="p">[</span><span class="n">first_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

</span><span id="line-190">
</span><span id="line-191">
<div class="viewcode-block" id="SobolAnalyser">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser">[docs]</a>
</span><span id="line-192"><span class="nd">@dataclass</span>
</span><span id="line-193"><span class="k">class</span><span class="w"> </span><span class="nc">SobolAnalyser</span><span class="p">:</span>
</span><span id="line-194"><span class="w">    </span><span class="sd">&quot;&quot;&quot; A class to perform Sobol sensitivity analysis using SALib.</span>
</span><span id="line-195"><span class="sd">    </span>
</span><span id="line-196"><span class="sd">    Attributes:</span>
</span><span id="line-197"><span class="sd">        problem: A SALibProblem instance defining the problem.</span>
</span><span id="line-198"><span class="sd">        variables: A list of Variable objects defining the model parameters.</span>
</span><span id="line-199"><span class="sd">        model: A callable model function that takes a list of variables.</span>
</span><span id="line-200"><span class="sd">        num_sampes: Number of samples to generate with Sobol sampling.</span>
</span><span id="line-201"><span class="sd">        calc_second_order: If True, calculates second-order Sobol indices.</span>
</span><span id="line-202"><span class="sd">        group_indices: If True, groups Sobol indices by variable groups.</span>
</span><span id="line-203"><span class="sd">    Raises:</span>
</span><span id="line-204"><span class="sd">        ValueError: If the number of variables in the problem does not match the number of variables</span>
</span><span id="line-205"><span class="sd">            provided, or if the variable names do not match the names in the problem definition.</span>
</span><span id="line-206"><span class="sd">    Usage:</span>
</span><span id="line-207"><span class="sd">        &gt;&gt;&gt; from utils.salib import SobolAnalyser, SALibProblem</span>
</span><span id="line-208"><span class="sd">        &gt;&gt;&gt; from utils.distributions import Variable, NormalDistribution</span>
</span><span id="line-209"><span class="sd">        &gt;&gt;&gt; problem = SALibProblem.from_variables(</span>
</span><span id="line-210"><span class="sd">        ...     variables=[</span>
</span><span id="line-211"><span class="sd">        ...         Variable(name=&#39;a&#39;, distribution=NormalDistribution(mean=0.0, std_dev=1.0)),</span>
</span><span id="line-212"><span class="sd">        ...         Variable(name=&#39;b&#39;, distribution=NormalDistribution(mean=0.0, std_dev=1.0)),</span>
</span><span id="line-213"><span class="sd">        ...         Variable(name=&#39;c&#39;, distribution=DiscreteNormalDistribution(mean=0.0, std_dev=1.0))</span>
</span><span id="line-214"><span class="sd">        ...     ]</span>
</span><span id="line-215"><span class="sd">        ... )</span>
</span><span id="line-216"><span class="sd">        &gt;&gt;&gt; model = TestModelSALibWrapper.from_variables(problem.variables)</span>
</span><span id="line-217"><span class="sd">        &gt;&gt;&gt; analyser = SobolAnalyser(</span>
</span><span id="line-218"><span class="sd">        ...     problem=problem,    </span>
</span><span id="line-219"><span class="sd">        ...     variables=problem.variables,</span>
</span><span id="line-220"><span class="sd">        ...     model=model,</span>
</span><span id="line-221"><span class="sd">        ...     num_samples=1000,</span>
</span><span id="line-222"><span class="sd">        ...     calc_second_order=True,</span>
</span><span id="line-223"><span class="sd">        ...     group_indices=True</span>
</span><span id="line-224"><span class="sd">        ... )</span>
</span><span id="line-225"><span class="sd">        &gt;&gt;&gt; sobol_results = analyser.run_sobol_sensitivity()</span>
</span><span id="line-226"><span class="sd">        &gt;&gt;&gt; print(sobol_results)</span>
</span><span id="line-227"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-228">    <span class="n">problem</span><span class="p">:</span> <span class="n">SALibProblem</span>
</span><span id="line-229">    <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Variable</span><span class="p">]</span>
</span><span id="line-230">    <span class="n">model</span><span class="p">:</span> <span class="n">SALibModelWrapperProtocol</span>
</span><span id="line-231">    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="line-232">    <span class="n">calc_second_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="line-233">    <span class="n">group_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="line-234">    <span class="n">_variable_cache</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="line-235">    
<div class="viewcode-block" id="SobolAnalyser.__post_init__">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser.__post_init__">[docs]</a>
</span><span id="line-236">    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-237"><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="line-238">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">num_vars</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">):</span>
</span><span id="line-239">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="line-240">                <span class="s2">&quot;Number of variables in the problem does not match the number of variables provided.&quot;</span><span class="p">)</span>
</span><span id="line-241">        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">):</span>
</span><span id="line-242">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="line-243">                <span class="s2">&quot;Variable names do not match the names in the problem definition.&quot;</span><span class="p">)</span>
</span><span id="line-244">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">names</span> <span class="o">!=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">]:</span>
</span><span id="line-245">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="line-246">                <span class="s2">&quot;Order of variables in the problem specification is different from that in the variable list.&quot;</span><span class="p">)</span>
</span><span id="line-247">        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_variable_cache&quot;</span><span class="p">,</span> <span class="p">{})</span></div>

</span><span id="line-248">        
<div class="viewcode-block" id="SobolAnalyser.get_variable">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser.get_variable">[docs]</a>
</span><span id="line-249">    <span class="k">def</span><span class="w"> </span><span class="nf">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Variable</span><span class="p">]:</span>
</span><span id="line-250"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a variable by its name, with memoization.&quot;&quot;&quot;</span>
</span><span id="line-251">        <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable_cache</span>
</span><span id="line-252">        <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
</span><span id="line-253">            <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
</span><span id="line-254">        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="line-255">            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">var_name</span><span class="p">:</span>
</span><span id="line-256">                <span class="n">cache</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span>
</span><span id="line-257">                <span class="k">return</span> <span class="n">var</span>
</span><span id="line-258">        <span class="n">cache</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="line-259">        <span class="k">return</span> <span class="kc">None</span></div>

</span><span id="line-260">    
<div class="viewcode-block" id="SobolAnalyser.run_sobol_sampling">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser.run_sobol_sampling">[docs]</a>
</span><span id="line-261">    <span class="k">def</span><span class="w"> </span><span class="nf">run_sobol_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">NumpyValue</span><span class="p">]:</span>
</span><span id="line-262"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run Sobol sampling to generate input samples.&quot;&quot;&quot;</span>
</span><span id="line-263">        <span class="c1"># Step 1 - Generate Sobol samples</span>
</span><span id="line-264">        <span class="n">sampled_inputs</span> <span class="o">=</span> <span class="n">sobol_sample</span><span class="p">(</span>
</span><span id="line-265">            <span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="line-266">            <span class="n">N</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span>  <span class="c1"># The number of samples will be N * (2D + 2) where D is the number of variables</span>
</span><span id="line-267">            <span class="n">calc_second_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_second_order</span><span class="p">,</span>
</span><span id="line-268">            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="line-269">        <span class="p">)</span>
</span><span id="line-270">        <span class="c1"># Step 2. Transform samples so that they follow tue parameter distributions</span>
</span><span id="line-271">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">using_unit_bounds</span><span class="p">:</span>
</span><span id="line-272">            <span class="c1"># If the bounds have been normalized, we need to transform them back to original</span>
</span><span id="line-273">            <span class="n">sampled_inputs</span> <span class="o">=</span> <span class="n">transform_uniform</span><span class="p">(</span><span class="n">sampled_inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
</span><span id="line-274">        <span class="k">return</span> <span class="n">sampled_inputs</span></div>

</span><span id="line-275">    
<div class="viewcode-block" id="SobolAnalyser.calculate_grouped_indices">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser.calculate_grouped_indices">[docs]</a>
</span><span id="line-276">    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_grouped_indices</span><span class="p">(</span>
</span><span id="line-277">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-278">            <span class="n">sobol_indices</span><span class="p">:</span> <span class="n">ResultDict</span>
</span><span id="line-279">        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">SobolIndexName</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">Numerical</span><span class="p">]]:</span>
</span><span id="line-280"><span class="w">        </span><span class="sd">&quot;&quot;&quot; Aggregate Sobol indices by variable groups.</span>
</span><span id="line-281"><span class="sd">        If no groups are defined, return the Sobol indices as is.</span>
</span><span id="line-282"><span class="sd">        Args:</span>
</span><span id="line-283"><span class="sd">            sobol_indices: A dictionary containing Sobol indices.</span>
</span><span id="line-284"><span class="sd">        Returns:</span>
</span><span id="line-285"><span class="sd">            A dictionary with aggregated Sobol indices by groups.</span>
</span><span id="line-286"><span class="sd">        Raises:</span>
</span><span id="line-287"><span class="sd">            ValueError: If the sobol_indices do not contain the expected keys.</span>
</span><span id="line-288"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-289">        <span class="n">grouped_sobol_indices</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="line-290">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
</span><span id="line-291">            <span class="c1"># If there are no groups defined, return an empty dict</span>
</span><span id="line-292">            <span class="k">return</span> <span class="n">grouped_sobol_indices</span>
</span><span id="line-293">        <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="line-294">            <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="n">sobol_indices</span><span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">][</span><span class="n">idxs</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="line-295">        <span class="k">if</span> <span class="s1">&#39;S2&#39;</span> <span class="ow">in</span> <span class="n">sobol_indices</span><span class="p">:</span>
</span><span id="line-296">            <span class="c1"># If second-order indices are calculated, aggregate them as well</span>
</span><span id="line-297">            <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="s1">&#39;S2&#39;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="line-298">                <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="n">sobol_indices</span><span class="p">[</span><span class="s1">&#39;S2&#39;</span><span class="p">][</span><span class="n">idxs</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="line-299">        <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="s1">&#39;ST&#39;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="line-300">            <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="n">sobol_indices</span><span class="p">[</span><span class="s1">&#39;ST&#39;</span><span class="p">][</span><span class="n">idxs</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="line-301">        <span class="k">return</span> <span class="n">grouped_sobol_indices</span></div>

</span><span id="line-302">    
<div class="viewcode-block" id="SobolAnalyser.run_sobol_scenarios">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser.run_sobol_scenarios">[docs]</a>
</span><span id="line-303">    <span class="k">def</span><span class="w"> </span><span class="nf">run_sobol_scenarios</span><span class="p">(</span>
</span><span id="line-304">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-305">            <span class="n">scenarios</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">ScenarioName</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">FixedVarName</span><span class="p">,</span> <span class="n">Numerical</span><span class="p">]],</span>
</span><span id="line-306">            <span class="n">pi_bounds</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">),</span>
</span><span id="line-307">            <span class="n">sobol_index</span><span class="p">:</span> <span class="n">SobolIndexName</span> <span class="o">=</span> <span class="s1">&#39;ST&#39;</span><span class="p">,</span>
</span><span id="line-308">            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SobolScenarioResults</span><span class="p">:</span>
</span><span id="line-309"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="line-310"><span class="sd">        Run Sobol analysis for multiple scenarios, where each scenario fixes some variables.</span>
</span><span id="line-311"><span class="sd">        Returns a dictionary mapping scenario names to SobolResults.</span>
</span><span id="line-312"><span class="sd">        Args:</span>
</span><span id="line-313"><span class="sd">            scenarios: A dictionary where keys are scenario names and values are dictionaries</span>
</span><span id="line-314"><span class="sd">                mapping variable names to fixed values for that scenario.</span>
</span><span id="line-315"><span class="sd">            pi_bounds: A tuple of two floats representing the lower and upper bounds for the</span>
</span><span id="line-316"><span class="sd">                percentile interval to calculate the nominal output.</span>
</span><span id="line-317"><span class="sd">            sobol_index: The Sobol index type to use for estimating variance contributions.</span>
</span><span id="line-318"><span class="sd">            **kwargs: Additional keyword arguments to pass to the Sobol sampling function.</span>
</span><span id="line-319"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-320">        <span class="c1"># NOTE: Variable has a `fixed` field but it is not used here currently.</span>
</span><span id="line-321">        <span class="n">scenario_ix_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">ScenarioName</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Numerical</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="line-322">            <span class="n">scenario_name</span><span class="p">:</span> <span class="p">{</span>
</span><span id="line-323">                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> <span class="n">fixed_value</span>
</span><span id="line-324">                <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">fixed_value</span> <span class="ow">in</span> <span class="n">fixed_var_names</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="line-325">            <span class="p">}</span>
</span><span id="line-326">            <span class="k">for</span> <span class="n">scenario_name</span><span class="p">,</span> <span class="n">fixed_var_names</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="line-327">        <span class="p">}</span>
</span><span id="line-328">        <span class="n">nominal_outputs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-329">        <span class="n">sobol_results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-330">        <span class="n">scenario_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-331">        <span class="c1"># Step 1 - Generate Sobol samples</span>
</span><span id="line-332">        <span class="n">sampled_inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_sobol_sampling</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="line-333">        
</span><span id="line-334">        <span class="c1"># Fix variables in the sampled inputs according to the scenario specifications</span>
</span><span id="line-335">        <span class="k">for</span> <span class="n">scenario_name</span><span class="p">,</span> <span class="n">fixed_vars</span> <span class="ow">in</span> <span class="n">scenario_ix_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="line-336">            <span class="n">scenario_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scenario_name</span><span class="p">)</span>
</span><span id="line-337">            <span class="n">fixed_var_names</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="line-338">                <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">fixed_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="line-339">            <span class="c1"># Create a copy of the sampled inputs to modify</span>
</span><span id="line-340">            <span class="n">fixed_inputs</span> <span class="o">=</span> <span class="n">sampled_inputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="line-341">            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">fixed_value</span> <span class="ow">in</span> <span class="n">fixed_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="line-342">                <span class="k">if</span> <span class="n">ix</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fixed_inputs</span><span class="p">):</span>
</span><span id="line-343">                    <span class="n">fixed_inputs</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">fixed_value</span>
</span><span id="line-344">                <span class="k">else</span><span class="p">:</span>
</span><span id="line-345">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">ix</span><span class="si">}</span><span class="s2"> is out of bounds for the input array.&quot;</span><span class="p">)</span>
</span><span id="line-346">            <span class="c1"># Step 2. Evaluate the model for the sampled inputs</span>
</span><span id="line-347">            <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fixed_inputs</span><span class="p">)</span>
</span><span id="line-348">            <span class="c1"># Step 3. Evaluate the model for the nominal input</span>
</span><span id="line-349">            <span class="n">ci_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">pi_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="line-350">            <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">pi_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="line-351">            <span class="n">nominal_values</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="line-352">                <span class="n">fixed_vars</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="k">if</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">fixed_vars</span> <span class="k">else</span> <span class="n">var</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">nominal_value</span> <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)]</span>
</span><span id="line-353">            <span class="c1"># NOTE: This should work as long as the index map is generated from variables!!! </span>
</span><span id="line-354">            <span class="c1">#       Double check later!!</span>
</span><span id="line-355">            <span class="n">nominal_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">nominal_values</span><span class="p">)</span>
</span><span id="line-356">            <span class="n">nominal_outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nominal_output</span><span class="p">)</span>
</span><span id="line-357">            <span class="c1"># Calculate sobol indices</span>
</span><span id="line-358">            <span class="n">sobol_indices</span> <span class="o">=</span> <span class="n">sobol</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span>
</span><span id="line-359">                <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">print_to_console</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="line-360">            <span class="n">ST_local</span> <span class="o">=</span> <span class="n">sobol_indices</span><span class="p">[</span><span class="s1">&#39;ST&#39;</span><span class="p">]</span>
</span><span id="line-361">            <span class="c1"># Group indices by variable groups (defined in each `variable` object)</span>
</span><span id="line-362">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_second_order</span><span class="p">:</span>
</span><span id="line-363">                <span class="n">sobol_indices</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
</span><span id="line-364">            <span class="c1"># Step 5 - </span>
</span><span id="line-365">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_indices</span><span class="p">:</span>
</span><span id="line-366">                <span class="n">grouped_sobol_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grouped_indices</span><span class="p">(</span><span class="n">sobol_indices</span><span class="p">)</span>
</span><span id="line-367">            <span class="k">else</span><span class="p">:</span>
</span><span id="line-368">                <span class="n">grouped_sobol_indices</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="line-369">            
</span><span id="line-370">            <span class="n">var_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="line-371">            <span class="n">sc_var</span> <span class="o">=</span> <span class="n">VarianceContributions</span><span class="p">(</span>
</span><span id="line-372">                <span class="n">sobol_index</span> <span class="o">=</span> <span class="n">sobol_index</span><span class="p">,</span>
</span><span id="line-373">                <span class="n">total_variance</span><span class="o">=</span><span class="n">var_Y</span><span class="p">,</span>
</span><span id="line-374">                <span class="n">contributions_by_group</span><span class="o">=</span><span class="p">{</span>
</span><span id="line-375">                    <span class="n">group</span><span class="p">:</span> <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="n">sobol_index</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">*</span> <span class="n">var_Y</span>
</span><span id="line-376">                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="n">sobol_index</span><span class="p">]</span>
</span><span id="line-377">                <span class="p">})</span>
</span><span id="line-378">            
</span><span id="line-379">            <span class="n">sobol_result</span> <span class="o">=</span> <span class="n">SobolResults</span><span class="p">(</span>
</span><span id="line-380">                <span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">,</span>
</span><span id="line-381">                <span class="n">nominal_output</span> <span class="o">=</span> <span class="n">nominal_output</span><span class="p">,</span>
</span><span id="line-382">                <span class="n">indices</span> <span class="o">=</span> <span class="n">sobol_indices</span><span class="p">,</span>
</span><span id="line-383">                <span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">],</span>
</span><span id="line-384">                <span class="n">fixed_var_names</span> <span class="o">=</span> <span class="n">fixed_var_names</span><span class="p">,</span>
</span><span id="line-385">                <span class="n">grouped_indices</span><span class="o">=</span><span class="n">grouped_sobol_indices</span><span class="p">,</span>
</span><span id="line-386">                <span class="n">variance_contributions</span> <span class="o">=</span> <span class="n">sc_var</span>
</span><span id="line-387">            <span class="p">)</span>
</span><span id="line-388">            <span class="n">sobol_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sobol_result</span><span class="p">)</span>
</span><span id="line-389">
</span><span id="line-390">        <span class="k">return</span> <span class="n">SobolScenarioResults</span><span class="p">(</span>
</span><span id="line-391">            <span class="n">sc_names</span> <span class="o">=</span> <span class="n">scenario_names</span><span class="p">,</span>
</span><span id="line-392">            <span class="n">results</span> <span class="o">=</span> <span class="n">sobol_results</span><span class="p">,</span>
</span><span id="line-393">        <span class="p">)</span></div>

</span><span id="line-394">    
<div class="viewcode-block" id="SobolAnalyser.run_sobol">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolAnalyser.run_sobol">[docs]</a>
</span><span id="line-395">    <span class="k">def</span><span class="w"> </span><span class="nf">run_sobol</span><span class="p">(</span>
</span><span id="line-396">            <span class="bp">self</span><span class="p">,</span>
</span><span id="line-397">            <span class="n">fix_variables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="line-398">            <span class="n">sobol_index</span><span class="p">:</span> <span class="n">SobolIndexName</span> <span class="o">=</span> <span class="s1">&#39;ST&#39;</span><span class="p">,</span>
</span><span id="line-399">            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SobolResults</span><span class="p">:</span>
</span><span id="line-400"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run Sobol sensitivity analysis.</span>
</span><span id="line-401"><span class="sd">        Args:</span>
</span><span id="line-402"><span class="sd">            fix_variables: If True, fix the variables to their nominal values.</span>
</span><span id="line-403"><span class="sd">            sobol_index: The Sobol index type to use for estimating variance contributions.</span>
</span><span id="line-404"><span class="sd">            **kwargs: Additional keyword arguments to pass to the Sobol sampling function.</span>
</span><span id="line-405"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-406">        <span class="k">if</span> <span class="n">fix_variables</span><span class="p">:</span>
</span><span id="line-407">            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="line-408">                <span class="s2">&quot;Fixing variables is not implemented in this method. Use `run_sobol_scenarios` instead.&quot;</span><span class="p">)</span>
</span><span id="line-409">        <span class="c1"># Step 1 - Generate Sobol samples</span>
</span><span id="line-410">        <span class="n">sampled_inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_sobol_sampling</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="line-411">        <span class="c1"># Step 2. Evaluate the model for the sampled inputs</span>
</span><span id="line-412">        <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sampled_inputs</span><span class="p">)</span> <span class="c1"># pylint: disable=assignment-from-no-return</span>
</span><span id="line-413">        <span class="c1"># Step 3. Evaluate the model for the nominal input</span>
</span><span id="line-414">        <span class="n">nominal_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">nominal_value</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">]</span>
</span><span id="line-415">        <span class="c1"># NOTE: This should work as long as the index map is generated from variables!!! Double check later!!</span>
</span><span id="line-416">        <span class="n">nominal_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">nominal_values</span><span class="p">)</span>
</span><span id="line-417">        <span class="c1"># Step 4 - Calculate sobol indices</span>
</span><span id="line-418">        <span class="n">sobol_indices</span> <span class="o">=</span> <span class="n">sobol</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">print_to_console</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="line-419">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_second_order</span><span class="p">:</span>
</span><span id="line-420">            <span class="n">sobol_indices</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
</span><span id="line-421">        <span class="c1"># Step 5 - Group indices by variable groups (defined in each `variable` object)</span>
</span><span id="line-422">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_indices</span><span class="p">:</span>
</span><span id="line-423">            <span class="n">grouped_sobol_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_grouped_indices</span><span class="p">(</span><span class="n">sobol_indices</span><span class="p">)</span>
</span><span id="line-424">            <span class="n">var_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="line-425">            <span class="n">sc_var</span> <span class="o">=</span> <span class="n">VarianceContributions</span><span class="p">(</span>
</span><span id="line-426">                <span class="n">sobol_index</span> <span class="o">=</span> <span class="n">sobol_index</span><span class="p">,</span>
</span><span id="line-427">                <span class="n">total_variance</span><span class="o">=</span><span class="n">var_Y</span><span class="p">,</span>
</span><span id="line-428">                <span class="n">contributions_by_group</span><span class="o">=</span><span class="p">{</span>
</span><span id="line-429">                    <span class="n">group</span><span class="p">:</span> <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="n">sobol_index</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">*</span> <span class="n">var_Y</span>
</span><span id="line-430">                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_sobol_indices</span><span class="p">[</span><span class="n">sobol_index</span><span class="p">]</span>
</span><span id="line-431">                <span class="p">})</span>            
</span><span id="line-432">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-433">            <span class="n">grouped_sobol_indices</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="line-434">            <span class="n">sc_var</span> <span class="o">=</span> <span class="kc">None</span>  
</span><span id="line-435">
</span><span id="line-436">        <span class="k">return</span> <span class="n">SobolResults</span><span class="p">(</span>
</span><span id="line-437">            <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
</span><span id="line-438">            <span class="n">nominal_output</span> <span class="o">=</span> <span class="n">nominal_output</span><span class="p">,</span>
</span><span id="line-439">            <span class="n">indices</span><span class="o">=</span><span class="n">sobol_indices</span><span class="p">,</span>
</span><span id="line-440">            <span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">],</span>
</span><span id="line-441">            <span class="n">fixed_var_names</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="line-442">            <span class="n">grouped_indices</span><span class="o">=</span><span class="n">grouped_sobol_indices</span><span class="p">,</span>
</span><span id="line-443">            <span class="n">variance_contributions</span> <span class="o">=</span> <span class="n">sc_var</span><span class="p">)</span></div>
</div>

</span><span id="line-444">
</span><span id="line-445">
<div class="viewcode-block" id="SobolBatchAnalyser">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolBatchAnalyser">[docs]</a>
</span><span id="line-446"><span class="nd">@dataclass</span>
</span><span id="line-447"><span class="k">class</span><span class="w"> </span><span class="nc">SobolBatchAnalyser</span><span class="p">:</span>
</span><span id="line-448"><span class="w">    </span><span class="sd">&quot;&quot;&quot; A class to perform Sobol sensitivity analysis for a batch of inputs.</span>
</span><span id="line-449"><span class="sd">    Attributes:</span>
</span><span id="line-450"><span class="sd">        problem: A SALibProblem instance defining the problem.</span>
</span><span id="line-451"><span class="sd">        batch_variables: A dictionary mapping scenario names to lists of Variable objects defining the model parameters.</span>
</span><span id="line-452"><span class="sd">        models: A dictionary mapping scenario names to SALibModelWrapperProtocol instances.</span>
</span><span id="line-453"><span class="sd">        num_samples: Number of samples to generate with Sobol sampling.</span>
</span><span id="line-454"><span class="sd">        calc_second_order: If True, calculates second-order Sobol indices.</span>
</span><span id="line-455"><span class="sd">        group_indices: If True, groups Sobol indices by variable groups.</span>
</span><span id="line-456"><span class="sd">    Raises:</span>
</span><span id="line-457"><span class="sd">        ValueError: If the number of batch variables does not match the number of models,</span>
</span><span id="line-458"><span class="sd">            or if the variable names do not match the model names.&quot;&quot;&quot;</span>
</span><span id="line-459">    <span class="n">problem</span><span class="p">:</span> <span class="n">SALibProblem</span>
</span><span id="line-460">    <span class="n">batch_variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">ScenarioName</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Variable</span><span class="p">]]</span>
</span><span id="line-461">    <span class="n">models</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">ScenarioName</span><span class="p">,</span> <span class="n">SALibModelWrapperProtocol</span><span class="p">]</span>
</span><span id="line-462">    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="line-463">    <span class="n">calc_second_order</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="line-464">    <span class="n">group_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="line-465">    
<div class="viewcode-block" id="SobolBatchAnalyser.__post_init__">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolBatchAnalyser.__post_init__">[docs]</a>
</span><span id="line-466">    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="line-467"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Post-initialization to validate the problem and batch variables.&quot;&quot;&quot;</span>
</span><span id="line-468">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_variables</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">):</span>
</span><span id="line-469">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of batch variables must match the number of models.&quot;</span><span class="p">)</span>
</span><span id="line-470">        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_variables</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
</span><span id="line-471">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All batch variable names must match the model names.&quot;</span><span class="p">)</span></div>

</span><span id="line-472">    
<div class="viewcode-block" id="SobolBatchAnalyser.run_sobol_batch">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SobolBatchAnalyser.run_sobol_batch">[docs]</a>
</span><span id="line-473">    <span class="k">def</span><span class="w"> </span><span class="nf">run_sobol_batch</span><span class="p">(</span>
</span><span id="line-474">            <span class="bp">self</span><span class="p">,</span> 
</span><span id="line-475">            <span class="n">fix_variables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
</span><span id="line-476">            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SobolScenarioResults</span><span class="p">:</span>
</span><span id="line-477"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run Sobol sensitivity analysis for a batch of inputs.&quot;&quot;&quot;</span>
</span><span id="line-478">        <span class="c1"># Similar to run_sobol_scenarios, but for a batch of inputs.</span>
</span><span id="line-479">        <span class="n">sobol_batch_results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SobolResults</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-480">        <span class="c1"># TODO: Scenario Variances need to be evaluated in this method</span>
</span><span id="line-481">        <span class="k">for</span> <span class="n">scenario_name</span><span class="p">,</span> <span class="n">variables</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="line-482">            <span class="n">analyser</span> <span class="o">=</span> <span class="n">SobolAnalyser</span><span class="p">(</span>
</span><span id="line-483">                <span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span>
</span><span id="line-484">                <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span>
</span><span id="line-485">                <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">scenario_name</span><span class="p">],</span>
</span><span id="line-486">                <span class="n">num_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span>
</span><span id="line-487">                <span class="n">calc_second_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_second_order</span><span class="p">,</span>
</span><span id="line-488">                <span class="n">group_indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_indices</span>
</span><span id="line-489">            <span class="p">)</span>
</span><span id="line-490">            <span class="n">results</span> <span class="o">=</span> <span class="n">analyser</span><span class="o">.</span><span class="n">run_sobol</span><span class="p">(</span><span class="n">fix_variables</span><span class="o">=</span><span class="n">fix_variables</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="line-491">            <span class="n">sobol_batch_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="line-492">            
</span><span id="line-493">        <span class="k">return</span> <span class="n">SobolScenarioResults</span><span class="p">(</span>
</span><span id="line-494">            <span class="n">sc_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_variables</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
</span><span id="line-495">            <span class="n">results</span> <span class="o">=</span> <span class="n">sobol_batch_results</span><span class="p">,</span>
</span><span id="line-496">        <span class="p">)</span></div>
</div>

</span><span id="line-497">
</span><span id="line-498">
<div class="viewcode-block" id="SALibProblem">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SALibProblem">[docs]</a>
</span><span id="line-499"><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="line-500"><span class="k">class</span><span class="w"> </span><span class="nc">SALibProblem</span><span class="p">:</span>
</span><span id="line-501"><span class="w">    </span><span class="sd">&quot;&quot;&quot; A dataclass to represent a SALib problem definition and construct</span>
</span><span id="line-502"><span class="sd">    SALib `problem` dictionary.</span>
</span><span id="line-503"><span class="sd">    </span>
</span><span id="line-504"><span class="sd">    Attributes:</span>
</span><span id="line-505"><span class="sd">        num_vars: Number of variables in the problem.</span>
</span><span id="line-506"><span class="sd">        names: List of variable names.</span>
</span><span id="line-507"><span class="sd">        bounds: List of bounds for each variable.</span>
</span><span id="line-508"><span class="sd">        groups: Optional dictionary mapping group names to lists of variable indices.</span>
</span><span id="line-509"><span class="sd">        use_groups_in_sobol: If True, use groups in Sobol analysis.</span>
</span><span id="line-510"><span class="sd">        using_unit_bounds: If True, all bounds are (0.0, 1.0).</span>
</span><span id="line-511"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-512">    <span class="n">num_vars</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="line-513">    <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="line-514">    <span class="n">bounds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="line-515">    <span class="n">groups</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="line-516">    <span class="n">use_groups_in_sobol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="line-517">    <span class="n">using_unit_bounds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="line-518">
<div class="viewcode-block" id="SALibProblem.__post_init__">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SALibProblem.__post_init__">[docs]</a>
</span><span id="line-519">    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="line-520"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Post-initialization to set the number of variables.&quot;&quot;&quot;</span>
</span><span id="line-521">        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;num_vars&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
</span><span id="line-522">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">:</span>
</span><span id="line-523">            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;bounds&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_vars</span><span class="p">)</span>
</span><span id="line-524">            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;using_unit_bounds&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="line-525">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_vars</span><span class="p">:</span>
</span><span id="line-526">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of bounds must match the number of variables.&quot;</span><span class="p">)</span>
</span><span id="line-527">        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;using_unit_bounds&quot;</span><span class="p">,</span> <span class="nb">all</span><span class="p">(</span><span class="n">bound</span> <span class="o">==</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">bound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">))</span></div>

</span><span id="line-528">
<div class="viewcode-block" id="SALibProblem.from_variables">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SALibProblem.from_variables">[docs]</a>
</span><span id="line-529">    <span class="nd">@classmethod</span>
</span><span id="line-530">    <span class="k">def</span><span class="w"> </span><span class="nf">from_variables</span><span class="p">(</span>
</span><span id="line-531">            <span class="bp">cls</span><span class="p">,</span>
</span><span id="line-532">            <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Variable</span><span class="p">],</span>
</span><span id="line-533">            <span class="n">use_groups_in_sobol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SALibProblem</span><span class="p">:</span>
</span><span id="line-534"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a SALibProblem instance from a list of Variable objects.</span>
</span><span id="line-535"><span class="sd">        Args:</span>
</span><span id="line-536"><span class="sd">            variables: A list of Variable objects defining the model parameters.</span>
</span><span id="line-537"><span class="sd">            use_groups_in_sobol: If True, use groups in Sobol analysis.</span>
</span><span id="line-538"><span class="sd">        Returns:</span>
</span><span id="line-539"><span class="sd">            A SALibProblem instance.</span>
</span><span id="line-540"><span class="sd">        Raises:</span>
</span><span id="line-541"><span class="sd">            ValueError: If there are duplicate variable names or if the bounds are not defined.</span>
</span><span id="line-542"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-543">        <span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>
</span><span id="line-544">        <span class="n">duplicates</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="line-545">        <span class="n">groups</span>  <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span id="line-546">        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
</span><span id="line-547">            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">group</span><span class="p">:</span>
</span><span id="line-548">                <span class="n">groups</span><span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
</span><span id="line-549">            <span class="k">else</span><span class="p">:</span>
</span><span id="line-550">                <span class="n">groups</span><span class="p">[</span><span class="s1">&#39;unknown&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
</span><span id="line-551">        <span class="k">if</span> <span class="n">duplicates</span><span class="p">:</span>
</span><span id="line-552">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicate variable names found: </span><span class="si">{</span><span class="n">duplicates</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="line-553">        <span class="n">distributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">distribution</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>
</span><span id="line-554">        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">has_bounds</span><span class="p">()</span> <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">distributions</span><span class="p">):</span>
</span><span id="line-555">            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
</span><span id="line-556">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-557">            <span class="c1"># Extract bounds from uniform and discrete-uniform distributions</span>
</span><span id="line-558">            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">bounds</span> <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">distributions</span><span class="p">]</span>
</span><span id="line-559">        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="line-560">            <span class="n">names</span><span class="o">=</span><span class="n">var_names</span><span class="p">,</span>
</span><span id="line-561">            <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
</span><span id="line-562">            <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span>
</span><span id="line-563">            <span class="n">use_groups_in_sobol</span><span class="o">=</span><span class="n">use_groups_in_sobol</span>
</span><span id="line-564">        <span class="p">)</span></div>

</span><span id="line-565">
<div class="viewcode-block" id="SALibProblem.to_dict">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.SALibProblem.to_dict">[docs]</a>
</span><span id="line-566">    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="line-567"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the SALibProblem instance to a dictionary.</span>
</span><span id="line-568"><span class="sd">        Returns:</span>
</span><span id="line-569"><span class="sd">            A dictionary representation of the SALib problem.</span>
</span><span id="line-570"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="line-571">        <span class="n">bounds_as_lists</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span> <span class="k">for</span> <span class="n">bound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">]</span>
</span><span id="line-572">        <span class="n">problem_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="line-573">            <span class="s1">&#39;num_vars&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_vars</span><span class="p">,</span>
</span><span id="line-574">            <span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
</span><span id="line-575">            <span class="s1">&#39;bounds&#39;</span><span class="p">:</span> <span class="n">bounds_as_lists</span><span class="p">,</span>
</span><span id="line-576">        <span class="p">}</span>
</span><span id="line-577">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_groups_in_sobol</span><span class="p">:</span>
</span><span id="line-578">            <span class="c1"># Convert a dict mapping keys to positions (int or iterable of ints)</span>
</span><span id="line-579">            <span class="c1"># into a list with keys placed at specified positions.</span>
</span><span id="line-580">            <span class="c1"># This function is used to convert the &#39;groups&#39; dict into a list</span>
</span><span id="line-581">            <span class="c1"># where each index corresponds to a parameter, and the value is the group name.</span>
</span><span id="line-582">            <span class="n">idx2key</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="line-583">                <span class="n">pos</span><span class="p">:</span> <span class="n">key</span>
</span><span id="line-584">                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="line-585">                <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="p">(</span><span class="n">val</span>
</span><span id="line-586">                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span>
</span><span id="line-587">                            <span class="k">else</span> <span class="p">[</span><span class="n">val</span><span class="p">])</span>
</span><span id="line-588">            <span class="p">}</span>
</span><span id="line-589">            <span class="n">max_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">idx2key</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="line-590">            <span class="c1"># fill from 0..max_idx, missing slots will be None</span>
</span><span id="line-591">            <span class="n">problem_dict</span><span class="p">[</span><span class="s1">&#39;sobol_groups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx2key</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="line-592">        <span class="k">return</span> <span class="n">problem_dict</span></div>
</div>

</span><span id="line-593">
</span><span id="line-594">
<div class="viewcode-block" id="transform_uniform">
<a class="viewcode-back" href="../../../api/generated/reemission.salib.runners.html#reemission.salib.runners.transform_uniform">[docs]</a>
</span><span id="line-595"><span class="k">def</span><span class="w"> </span><span class="nf">transform_uniform</span><span class="p">(</span>
</span><span id="line-596">        <span class="n">uniform_samples</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">NumpyValue</span><span class="p">],</span>
</span><span id="line-597">        <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Variable</span><span class="p">],</span> 
</span><span id="line-598">        <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">NumpyValue</span><span class="p">]:</span>
</span><span id="line-599"><span class="w">    </span><span class="sd">&quot;&quot;&quot; Transforms uniform samples U to the distributions defined by the variables.</span>
</span><span id="line-600"><span class="sd">    Args:</span>
</span><span id="line-601"><span class="sd">        uniform_samples: NDArray of uniform samples, shape (num_samples, num_variables)</span>
</span><span id="line-602"><span class="sd">        variables: List of Variable objects defining the distributions.</span>
</span><span id="line-603"><span class="sd">        eps: Small value to prevent numerical issues when transforming uniform samples.</span>
</span><span id="line-604"><span class="sd">    Returns:</span>
</span><span id="line-605"><span class="sd">        NDArray of transformed samples, shape (num_samples, num_variables).</span>
</span><span id="line-606"><span class="sd">    Note:</span>
</span><span id="line-607"><span class="sd">        Variables in the `variables` list must be in the same order as the columns in `uniform_samples`.</span>
</span><span id="line-608"><span class="sd">    Raises:</span>
</span><span id="line-609"><span class="sd">        TypeError: If `uniform_samples` is not a numpy ndarray.</span>
</span><span id="line-610"><span class="sd">        ValueError: If `uniform_samples` is not a 2D array or if the number of variables does not match the shape of `uniform_samples`.</span>
</span><span id="line-611"><span class="sd">        ValueError: If `variables` list is empty or contains non-Variable objects.</span>
</span><span id="line-612"><span class="sd">        ValueError: If a variable&#39;s distribution type is not supported.</span>
</span><span id="line-613"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="line-614">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uniform_samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="line-615">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;U must be a numpy ndarray&quot;</span><span class="p">)</span>
</span><span id="line-616">    <span class="k">if</span> <span class="n">uniform_samples</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="line-617">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;U must be a 2D array with shape (num_samples, num_variables)&quot;</span><span class="p">)</span>
</span><span id="line-618">    <span class="k">if</span> <span class="ow">not</span> <span class="n">variables</span><span class="p">:</span>
</span><span id="line-619">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;variables list cannot be empty&quot;</span><span class="p">)</span>
</span><span id="line-620">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">):</span>
</span><span id="line-621">        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All elements in variables must be instances of Variable class&quot;</span><span class="p">)</span>
</span><span id="line-622">    <span class="n">num_samples</span><span class="p">,</span> <span class="n">num_variables</span> <span class="o">=</span> <span class="n">uniform_samples</span><span class="o">.</span><span class="n">shape</span>
</span><span id="line-623">    <span class="k">if</span> <span class="n">num_variables</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
</span><span id="line-624">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of variables does not match the shape of U&quot;</span><span class="p">)</span>
</span><span id="line-625">    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">uniform_samples</span><span class="p">)</span>
</span><span id="line-626">    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">variable</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
</span><span id="line-627">        <span class="n">uniform_samples_transformed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">uniform_samples</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">eps</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">)</span> <span class="c1"># prevents numerical issues when transforming uniform samples to other distributions</span>
</span><span id="line-628">        <span class="n">dist_type</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">type</span>
</span><span id="line-629">        <span class="k">if</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">:</span>
</span><span id="line-630">            <span class="n">mu</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">mean</span>
</span><span id="line-631">            <span class="n">sigma</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">std_dev</span>
</span><span id="line-632">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">uniform_samples_transformed</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
</span><span id="line-633">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">UNIFORM</span><span class="p">:</span>
</span><span id="line-634">            <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">bounds</span>
</span><span id="line-635">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">low</span> <span class="o">+</span> <span class="n">uniform_samples_transformed</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span>
</span><span id="line-636">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">DISCRETEUNIFORM</span><span class="p">:</span>
</span><span id="line-637">            <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">bound</span>
</span><span id="line-638">            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Add 1 so that we can use floor</span>
</span><span id="line-639">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">uniform_samples_transformed</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># Convert to discrete values</span>
</span><span id="line-640">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="line-641">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="line-642">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">DISCRETENORMAL</span><span class="p">:</span>
</span><span id="line-643">            <span class="n">mu</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">mean</span>
</span><span id="line-644">            <span class="n">sigma</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">std_dev</span>
</span><span id="line-645">            <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">bound</span>
</span><span id="line-646">            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="line-647">            <span class="c1"># Map uniform to normal, then to nearest integer in bounds</span>
</span><span id="line-648">            <span class="n">norm_vals</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">uniform_samples_transformed</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
</span><span id="line-649">            <span class="n">int_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">norm_vals</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="line-650">            <span class="n">int_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">int_vals</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
</span><span id="line-651">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_vals</span>
</span><span id="line-652">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">DISCRETEHISTOGRAM</span><span class="p">:</span>
</span><span id="line-653">            <span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="line-654">            <span class="n">probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">probabilities</span><span class="p">)</span>
</span><span id="line-655">            <span class="n">cum_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
</span><span id="line-656">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">cum_probs</span><span class="p">,</span> <span class="n">uniform_samples_transformed</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="line-657">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="line-658">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">CATEGORICALUNIFORM</span><span class="p">:</span>
</span><span id="line-659">            <span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="line-660">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">uniform_samples_transformed</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="line-661">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="line-662">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">cat_to_num</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</span><span id="line-663">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">CATEGORICALNORMAL</span><span class="p">:</span>
</span><span id="line-664">            <span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="line-665">            <span class="n">mu</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">mean</span>
</span><span id="line-666">            <span class="n">sigma</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">std_dev</span>
</span><span id="line-667">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">uniform_samples_transformed</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="line-668">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="line-669">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">cat_to_num</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</span><span id="line-670">        <span class="k">elif</span> <span class="n">dist_type</span> <span class="o">==</span> <span class="n">DistributionType</span><span class="o">.</span><span class="n">CATEGORICALHISTOGRAM</span><span class="p">:</span>
</span><span id="line-671">            <span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="line-672">            <span class="n">probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">probabilities</span><span class="p">)</span>
</span><span id="line-673">            <span class="n">cum_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
</span><span id="line-674">            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">cum_probs</span><span class="p">,</span> <span class="n">uniform_samples_transformed</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</span><span id="line-675">            <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">cat_to_num</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</span><span id="line-676">        <span class="k">else</span><span class="p">:</span>
</span><span id="line-677">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported distribution type: </span><span class="si">{</span><span class="n">dist_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="line-678">    <span class="k">return</span> <span class="n">X</span></div>

</span><span id="line-679">
</span><span id="line-680">
</span><span id="line-681"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="line-682">    <span class="c1"># Example usage</span>
</span><span id="line-683">    <span class="n">salib_problem_1</span> <span class="o">=</span> <span class="n">SALibProblem</span><span class="o">.</span><span class="n">from_variables</span><span class="p">(</span>
</span><span id="line-684">        <span class="n">variables</span><span class="o">=</span><span class="p">[</span>
</span><span id="line-685">            <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">NormalDistribution</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)),</span>
</span><span id="line-686">            <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">NormalDistribution</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)),</span>
</span><span id="line-687">            <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">DiscreteNormalDistribution</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
</span><span id="line-688">        <span class="p">]</span>
</span><span id="line-689">    <span class="p">)</span>
</span><span id="line-690">    <span class="n">salib_problem_2</span> <span class="o">=</span> <span class="n">SALibProblem</span><span class="o">.</span><span class="n">from_variables</span><span class="p">(</span>
</span><span id="line-691">        <span class="n">variables</span><span class="o">=</span><span class="p">[</span>
</span><span id="line-692">            <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">UniformDistribution</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.634</span><span class="p">))),</span>
</span><span id="line-693">            <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">DiscreteUniformDistribution</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">))),</span>
</span><span id="line-694">        <span class="p">]</span>
</span><span id="line-695">    <span class="p">)</span>
</span><span id="line-696">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SALib problem 1&quot;</span><span class="p">,</span> <span class="n">salib_problem_1</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
</span><span id="line-697">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SALib problem 2&quot;</span><span class="p">,</span> <span class="n">salib_problem_2</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
</span></code></pre></div>
    </div><div class="flex justify-between items-center pt-6 mt-12 border-t border-border gap-4">
</div></div>
        </main>
      </div>
    </div><footer class="py-6 border-t border-border md:py-0">
    <div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
      <div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
        <p class="text-sm leading-loose text-center text-muted-foreground md:text-left">Â© 2024, Tomasz Janus, University of Manchester, United Kingdom&nbsp;Built with <a class="font-medium underline underline-offset-4"
    href="https://www.sphinx-doc.org"
    rel="noreferrer">Sphinx 8.1.3</a></p>
</div>
</div>
</footer>
  </div>
  
    <script src="../../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/toggleprompt.js?v=5801b3bb"></script>
    <script defer="defer" src="../../../_static/theme.js?v=073f68d9"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
  
</body>
</html>